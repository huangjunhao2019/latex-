!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.main=n():(e.Frontend=e.Frontend||{},e.Frontend.main=n())}(window,(function(){return function(e){function n(n){for(var r,i,c=n[0],l=n[1],s=n[2],d=0,f=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(u&&u(n);f.length;)f.shift()();return a.push.apply(a,s||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],r=!0,c=1;c<t.length;c++){var l=t[c];0!==o[l]&&(r=!1)}r&&(a.splice(n--,1),e=i(i.s=t[0]))}return e}var r={},o={5:0},a=[];function i(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=r,i.d=function(e,n,t){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)i.d(t,r,function(n){return e[n]}.bind(null,r));return t},i.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=n,c=c.slice();for(var s=0;s<c.length;s++)n(c[s]);var u=l;return a.push([141,0]),t()}([function(e,n,t){var r,o;function a(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e,n){return null!=e?n(e):void 0}t.p=window.baseAssetPath,r=[t(29),t(56),t(57),t(31),t(58),t(59)],void 0===(o=function(){var e=angular.module("SharelatexApp",["ui.bootstrap","autocomplete","RecursionHelper","ng-context-menu","underscore","ngSanitize","ipCookie","ErrorCatcher","localStorage","sessionStorage","ngTagsInput","ui.select"]).config(["$qProvider","$httpProvider","uiSelectConfig",function(e,n,t){return e.errorOnUnhandledRejections(!1),t.spinnerClass="fa fa-refresh ui-select-spin",i("undefined"!=typeof MathJax&&null!==MathJax?MathJax.Hub:void 0,(function(e){return e.Config({messageStyle:"none",imageFont:null,"HTML-CSS":{availableFonts:["TeX"],scale:110,matchFontHeight:!1},TeX:{equationNumbers:{autoNumber:"AMS"},useLabelIDs:!1},skipStartupTypeset:!0,tex2jax:{processEscapes:!0,inlineMath:[["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]}})}))}]);e.run(["$templateCache",function(e){return e.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open && $select.searchEnabled" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""></span> <i class="caret pull-right" ng-click="$select.toggle($event)"></i> <a ng-show="$select.allowClear && !$select.isEmpty() && ($select.disabled !== true)" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="fa fa-times" aria-hidden="true"></i></a></span></div>')}]);var n=null!=i(null!=window.location?window.location.search:void 0,(function(e){return e.match(/debug=true/)})),t=null;return window.sl_debugging=n,window.sl_console={log:function(){if(n){var e;t=null;for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=console).log.apply(e,a(Array.from(o||[])))}},logOnce:function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];var i;if(n&&r[0]!==t)return t=r[0],(i=console).log.apply(i,a(Array.from(r||[])))}},e}.apply(n,r))||(e.exports=o)},,,,,,,,,function(e,n,t){var r,o;function a(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r=[t(11)],void 0===(o=function(e){return{getColorScheme:function(e,n){return this.isDarkTheme(n)?{cursor:"hsl(".concat(e,", 70%, 50%)"),labelBackgroundColor:"hsl(".concat(e,", 70%, 50%)"),highlightBackgroundColor:"hsl(".concat(e,", 100%, 28%);"),strikeThroughBackgroundColor:"hsl(".concat(e,", 100%, 20%);"),strikeThroughForegroundColor:"hsl(".concat(e,", 100%, 60%);")}:{cursor:"hsl(".concat(e,", 70%, 50%)"),labelBackgroundColor:"hsl(".concat(e,", 70%, 50%)"),highlightBackgroundColor:"hsl(".concat(e,", 70%, 85%);"),strikeThroughBackgroundColor:"hsl(".concat(e,", 70%, 95%);"),strikeThroughForegroundColor:"hsl(".concat(e,", 70%, 40%);")}},isDarkTheme:function(e){var n=e.find(".ace_editor").css("background-color"),t=a(Array.from(n.match(/rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)/)),4),r=(t[0],t[1]),o=t[2],i=t[3];return(r=parseInt(r,10))+(o=parseInt(o,10))+(i=parseInt(i,10))<384},OWN_HUE:200,ANONYMOUS_HUE:100,getHueForUserId:function(e){return null==e||"anonymous-user"===e?this.ANONYMOUS_HUE:window.user.id===e?this.OWN_HUE:(hue=this.getHueForId(e),hue>this.OWNER_HUE-20&&(hue+=40),hue)},getHueForTagId:function(e){return this.getHueForId(e)},getHueForId:function(n){var t=e(n);return parseInt(t.toString().slice(0,8),16)%320}}}.apply(n,r))||(e.exports=o)},,,,,,,,,,,,,,,,,,,,function(e,n,t){var r,o;r=[t(77),t(98),t(102),t(16),t(103),t(104),t(105),t(106),t(107),t(108),t(109),t(110),t(37),t(111),t(112)],void 0===(o=function(){}.apply(n,r))||(e.exports=o)},,function(e,n){angular.module("localStorage",[]).value("localStorage",(function(){try{var e;return(e=$).localStorage.apply(e,arguments)}catch(e){return console.error("localStorage exception",e),null}}))},,,,,,,function(e,n,t){var r,o;function a(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r=[t(0)],void 0===(o=function(e){return e.factory("queuedHttp",["$http","$q",function(e,n){var t=[],r=!1,o=function e(){if(!r){var n=t.shift();return null!=n?(r=!0,n().then((function(){return r=!1,e()})).catch((function(){return r=!1,e()}))):void 0}},i=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var c={},l=[],s=[];c.then=function(e,n){return l.push(e),null!=n&&s.push(n),c},c.catch=function(e){return s.push(e),c};var u=function(){return e.apply(void 0,a(Array.from(r||[]))).then((function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Array.from(l).map((function(e){return e.apply(void 0,a(Array.from(n||[])))}))})).catch((function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Array.from(s).map((function(e){return e.apply(void 0,a(Array.from(n||[])))}))}))};return t.push(u),o(),c};return i.post=function(e,n){return i({method:"POST",url:e,data:n})},i}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.directive("mathjax",["$compile","$parse",function(e,n){return{link:function(t,r,o){if(MathJax&&MathJax.Hub){if(!n(o.mathjaxAllowHtml)(t)){var a=r.html(),i=e("<span ng-non-bindable></span>")({});r.html("").append(i),i.html(a)}if("no-single-dollar"!==o.delimiter){var c=MathJax.Hub.config&&MathJax.Hub.config.tex2jax.inlineMath;_.find(c,(function(e){return"$"===e[0]&&"$"===e[1]}))||MathJax.Hub.Config({tex2jax:{inlineMath:c.concat([["$","$"]])}})}setTimeout((function(){MathJax.Hub.Queue(["Typeset",MathJax.Hub,r.get(0)])}),0)}}}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;function a(e,n){return null!=e?n(e):void 0}r=[t(0),t(41)],void 0===(o=function(e,n){return e.factory("algoliaSearch",(function(){var e,t;if(null!=(null!=window.sharelatex?window.sharelatex.algolia:void 0)&&null!=a(null!=window.sharelatex.algolia?window.sharelatex.algolia.indexes:void 0,(function(e){return e.wiki}))){var r=n(null!=window.sharelatex.algolia?window.sharelatex.algolia.app_id:void 0,null!=window.sharelatex.algolia?window.sharelatex.algolia.api_key:void 0);t=r.initIndex(a(null!=window.sharelatex.algolia?window.sharelatex.algolia.indexes:void 0,(function(e){return e.wiki}))),e=r.initIndex(a(null!=window.sharelatex.algolia?window.sharelatex.algolia.indexes:void 0,(function(e){return e.kb})))}return{searchWiki:t?t.search.bind(t):null,searchKB:e?e.search.bind(e):null}}))}.apply(n,r))||(e.exports=o)},,,,,,,,,,,,,,,,function(e,n){angular.module("RecursionHelper",[]).factory("RecursionHelper",["$compile",function(e){return{compile:function(n,t){angular.isFunction(t)&&(t={post:t});var r,o=n.contents().remove();return{pre:t&&t.pre?t.pre:null,post:function(n,a){r||(r=e(o)),r(n,(function(e){a.append(e)})),t&&t.post&&t.post.apply(null,arguments)}}}}}])},function(e,n){var t=angular.module("ErrorCatcher",[]);t.config(["$provide",function(e){return e.decorator("$exceptionHandler",["$log","$delegate",function(e,n){return function(e,t){if("Possibly unhandled rejection: canceled"!==e||void 0!==t)return null!=("undefined"!=typeof Raven&&null!==Raven?Raven.captureException:void 0)&&Raven.captureException(e),n(e,t)}}])}]),t.factory("unAuthHttpResponseInterceptor",["$q","$location",function(e,n){return{responseError:function(n){return[401,403].includes(n.status)&&!(null!=n.config?n.config.disableAutoLoginRedirect:void 0)&&(window.location.pathname.match(/^\/project/)?window.location="/login?redir=".concat(encodeURI(window.location.pathname)):window.location="/login"),e.reject(n)}}}]),t.config(["$httpProvider",function(e){return e.interceptors.push("unAuthHttpResponseInterceptor")}])},function(e,n){angular.module("sessionStorage",[]).value("sessionStorage",(function(){try{var e;return(e=$).sessionStorage.apply(e,arguments)}catch(e){return console.error("sessionStorage exception",e),null}}))},function(e,n,t){var r,o;r=[t(29)],void 0===(o=function(){return angular.module("underscore",[]).factory("_",(function(){return window._}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("FreeTrialModalController",["$scope","eventTracking",function(e,n){e.buttonClass="btn-primary",e.startFreeTrial=function(t,r){var o,a="collaborator_free_trial_7_days",i=window.open();"function"==typeof ga&&ga("send","event","subscription-funnel","upgraded-free-trial",t),o="/user/subscription/new?planCode=".concat(a,"&ssp=true"),o="".concat(o,"&itm_campaign=").concat(t),r&&(o="".concat(o,"&itm_content=").concat(r)),e.startedFreeTrial=!0,n.sendMB("subscription-start-trial",{source:t,plan:a}),i.location=o}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(2),t(0),t(31)],void 0===(o=function(e,n){var t=0,r=new Date;return n.factory("eventTracking",["$http","localStorage",function(n,o){var a=function(){var e=o("mbEvents");return null==e&&o("mbEvents",e={}),e},i=function(e){return a()[e]||!1},c=function(e){var n=a();return n[e]=!0,o("mbEvents",n)};return{send:function(e,n,t,r){return ga("send","event",e,n,t,r)},sendGAOnce:function(e,n,t,r){if(!i(n))return c(n),this.send(e,n,t,r)},editingSessionHeartbeat:function(){if(r<=new Date){n({url:"/editingSession/".concat(window.project_id),method:"PUT",headers:{"X-CSRF-Token":window.csrfToken}});var o=++t<=2?30:t<=6?60*(t-2):300;return r=e().add(o,"seconds").toDate()}},sendMB:function(e,t){return null==t&&(t={}),n({url:"/event/".concat(e),method:"POST",data:t,headers:{"X-CSRF-Token":window.csrfToken}})},sendMBSampled:function(e,n){if(Math.random()<.01)return this.sendMB(e,n)},sendMBOnce:function(e,n){if(!i(e))return c(e),this.sendMB(e,n)},eventInCache:function(e){return i(e)}}}]),$(".navbar a").on("click",(function(e){var n=$(e.target).attr("href");if(null!=n)return ga("send","event","navigation","top menu bar",n)}))}.apply(n,r))||(e.exports=o)},,,function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){e.constant("ExposedSettings",window.ExposedSettings)}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(11)],void 0===(o=function(e,n){var t=["sl_abt_multi_currency_editor_eu-eu","sl_abt_multi_currency_eu-eu","sl_abt_multi_currency_editor_eu-usd","sl_abt_multi_currency_eu-usd","sl_abt_trial_len_14d","sl_abt_trial_len_7d","sl_abt_trial_len_30d","sl_utt","sl_utt_trial_len","sl_utt_multi_currency"];return e.factory("abTestManager",["$http","ipCookie",function(e,r){_.each(t,(function(e){return r.remove(e)}));var o=function(e,n){return"sl_abt_".concat(e,"_").concat(n)};return{processTestWithStep:function(e,n,t){var a,i;if(function(e,n){return(null!=e||0===n)&&(0===n||e+1===n)}((a=function(e,n){var t=o(e,n);return r(t)}(e,n),i=function(e){return e.step},null!=a?i(a):void 0),t))return function(e,n,t){var a=o(e,n);return r(a,{step:t},{expires:100,path:"/"}),ga("send","event","ab_tests","".concat(e,":").concat(n),"step-".concat(t))}(e,n,t)},getABTestBucket:function(e,t){var o,a,i,c=(a="sl_utt_".concat(o=e),null==(i=r(a))&&(i=Math.random(),r(a,i,{expires:365,path:"/"})),n("".concat(i,":").concat(o)));return t[parseInt(c.toString().slice(0,2),16)%((null!=t?t.length:void 0)||2)]}}}]),e.controller("AbTestController",["$scope","abTestManager",function(e,n){_.keys(window.ab);return _.each(window.ab,(function(e){return n.processTestWithStep(e.testName,e.bucket,e.step)}))}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.directive("stopPropagation",["$http",function(e){return{restrict:"A",link:function(e,n,t){return n.bind(t.stopPropagation,(function(e){return e.stopPropagation()}))}}}]),e.directive("preventDefault",["$http",function(e){return{restrict:"A",link:function(e,n,t){return n.bind(t.preventDefault,(function(e){return e.preventDefault()}))}}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){var n;e.directive("focusWhen",["$timeout",function(e){return{restrict:"A",link:function(n,t,r){return n.$watch(r.focusWhen,(function(n){if(n)return e((function(){return t.focus()}))}))}}}]),e.directive("focusOn",["$timeout",function(e){return{restrict:"A",link:function(e,n,t){return e.$on(t.focusOn,(function(){return n.focus()}))}}}]),e.directive("selectWhen",["$timeout",function(e){return{restrict:"A",link:function(n,t,r){return n.$watch(r.selectWhen,(function(n){if(n)return e((function(){return t.select()}))}))}}}]),e.directive("selectOn",["$timeout",function(e){return{restrict:"A",link:function(e,n,t){return e.$on(t.selectOn,(function(){return n.select()}))}}}]),e.directive("selectNameWhen",["$timeout",function(e){return{restrict:"A",link:function(t,r,o){return t.$watch(o.selectNameWhen,(function(t){if(t)return e((function(){return n(r)}))}))}}}]),e.directive("selectNameOn",(function(){return{restrict:"A",link:function(e,t,r){return e.$on(r.selectNameOn,(function(){return n(t)}))}}})),e.directive("focus",["$timeout",function(e){return{scope:{trigger:"@focus"},link:function(n,t){return n.$watch("trigger",(function(n){if("true"===n)return e((function(){return t[0].focus()}))}))}}}]),n=function(e){e.focus();var n=e.val();if(null!=e[0].setSelectionRange){var t=n.lastIndexOf(".");return-1===t&&(t=n.length),e[0].setSelectionRange(0,t)}}}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(122)],void 0===(o=function(e,n){return e.directive("fineUpload",["$timeout",function(e){return{scope:{multiple:"=",endpoint:"@",templateId:"@",sizeLimit:"@",allowedExtensions:"=",onCompleteCallback:"=",onUploadCallback:"=",onValidateBatch:"=",onErrorCallback:"=",onSubmitCallback:"=",onCancelCallback:"=",autoUpload:"=",params:"=",control:"="},link:function(e,t,r){var o,a,i=e.multiple||!1,c=e.endpoint,l=e.templateId;a=null!=e.allowedExtensions?{allowedExtensions:e.allowedExtensions}:{},e.sizeLimit&&(a.sizeLimit=e.sizeLimit);var s=e.maxConnections||1,u=e.onCompleteCallback||function(){},d=e.onUploadCallback||function(){},f=e.onErrorCallback||function(){},p=e.onValidateBatch||function(){},m=e.onSubmitCallback||function(){},h=e.onCancelCallback||function(){};o=null==e.autoUpload||e.autoUpload;var g=e.params||{};g._csrf=window.csrfToken;var v=new n.FineUploader({element:t[0],multiple:i,autoUpload:o,disabledCancelForFormUploads:!0,validation:a,maxConnections:s,request:{endpoint:c,forceMultipart:!0,params:g,paramsInBody:!1},callbacks:{onComplete:u,onUpload:d,onValidateBatch:p,onError:f,onSubmit:m,onCancel:h},template:l,failedUploadTextDisplay:{mode:"custom",responseProperty:"error"}});return window.q=v,null!=e.control&&(e.control.q=v),v}}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.directive("onEnter",(function(){return function(e,n,t){return n.bind("keydown keypress",(function(n){if(13===n.which)return e.$apply((function(){return e.$eval(t.onEnter,{event:n})})),n.preventDefault()}))}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.factory("validateCaptcha",(function(){var e=[],n=function(n){for(var t=0,r=e;t<r.length;t++){(0,r[t])(n)}e=[]},t=null;return function(r,o){if(null==r&&(r=function(e){}),"undefined"==typeof grecaptcha||null===grecaptcha||o)return r();if(e.push(r),e.push((function(){return grecaptcha.reset()})),null==t){var a=$("#recaptcha")[0];t=grecaptcha.render(a,{callback:n})}return grecaptcha.execute(t)}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.factory("validateCaptchaV3",(function(){var e=window.grecaptcha,n=window.ExposedSettings;return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e&&n&&n.recaptchaSiteKeyV3&&e.ready((function(){e.execute(n.recaptchaSiteKeyV3,{action:t}).then(r)}))}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(2)],void 0===(o=function(e,n){n.updateLocale("en",{calendar:{lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",lastWeek:"ddd, Do MMM YY",nextWeek:"ddd, Do MMM YY",sameElse:"ddd, Do MMM YY"}}),e.filter("formatDate",(function(){return function(e,t){return e?(null==t&&(t="Do MMM YYYY, h:mm a"),n(e).format(t)):"N/A"}})),e.filter("relativeDate",(function(){return function(e){return n(e).calendar()}})),e.filter("fromNowDate",(function(){return function(e){return n(e).fromNow()}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(40)],void 0===(o=function(e){return e.controller("ContactModal",["$scope","$modal","sessionStorage",function(e,n,t){t("contact-form.user-input",null),e.contactUsModal=function(){n.open({templateUrl:"contactModalTemplate",controller:"ContactModalController",scope:e})}}]),e.controller("ContactGeneralModal",["$scope","$modal","sessionStorage",function(e,n,t){t("contact-form.user-input",null),e.openModal=function(){n.open({templateUrl:"contactGeneralModalTemplate",controller:"ContactGeneralModalController"})}}]),e.controller("ContactModalController",["$scope","$modalInstance",function(e,n){return e.close=function(){return n.close()}}]),e.controller("ContactGeneralModalController",["$scope","$modalInstance",function(e,n){return e.close=function(){return n.close()}}]),e.controller("ContactFormController",["$scope","algoliaSearch","eventTracking","$http","sessionStorage",function(e,n,t,r,o){var a=o("contact-form.user-input");a?e.form=a:(e.form={email:""},window.project_id&&(e.form.project_url=window.location.href)),e.sent=!1,e.sending=!1,e.suggestions=[],e.$on("modal.closing",(function(){e.sent?o("contact-form.user-input",null):o("contact-form.user-input",{subject:e.form.subject,message:e.form.message,project_url:e.form.project_url})}));var i=function(n,r){var o=function(){for(var e,n,t=[],o=0,a=Array.from(r.hits);o<a.length;o++){var i=a[o],c=(e=null!=i?i.pageName:void 0,n=function(e){return e.replace(/\s/g,"_")},null!=e?n(e):void 0),l=encodeURIComponent(c),s=i.kb?"how-to":"latex",u=i.sectionName&&""!==i.sectionName,d=u?"#".concat(i.sectionName.replace(/\s/g,"_")):"",f=i._highlightResult.pageName.value;u&&(f+=" - "+i.sectionName),t.push({url:"/learn/".concat(s,"/").concat(l).concat(d),name:f})}return t}();return r.hits.length&&t.sendMB("contact-form-suggestions-shown"),e.$applyAsync((function(){return e.suggestions=o}))};e.contactUs=function(){if(null!=e.form.email&&""!==e.form.email){e.sending=!0;var n=Math.floor(65536*(1+Math.random())).toString(32),t=e.form.message;null!=e.form.project_url&&(t="".concat(t,"\n\n project_url = ").concat(e.form.project_url));var o={_csrf:window.csrfToken,email:e.form.email,message:t||"",subject:e.form.subject+" - [".concat(n,"]"),labels:"support",inbox:e.inbox||"support"},a=r.post("/support",o);return a.then((function(n){return e.sent=!0})),a.catch((function(){return e.error=!0,e.sending=!1,console.log("the request failed")}))}console.log("email not set")},e.$watch("inbox",(function(n){return e.inbox}))();var c=e.$watch("showContactFormSuggestions",(function(e){if(null!=e)return!0===e&&l(),c()})),l=function(){return e.$watch("form.subject",(function(t,r){if(!(t&&t!==r&&t.length>3))return e.suggestions=[];n.searchWiki(t,{hitsPerPage:3,typoTolerance:"strict"},i)}))};return e.clickSuggestionLink=function(e){return t.sendMB("contact-form-suggestions-clicked",{url:e})}}])}.apply(n,r))||(e.exports=o)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,n,t){var r,o;function a(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,n){return null!=e?n(e):void 0}r=[t(0)],void 0===(o=function(e){return e.factory("ccUtils",(function(){var e=/(\d{1,4})/g,n=[{type:"visa",patterns:[4],format:e,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",patterns:[60,64,65,622],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",patterns:[62,88],format:e,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",patterns:[35],format:e,length:[16],cvcLength:[3],luhn:!0}],t=function(e){e=(e+"").replace(/\D/g,"");for(var t=0,r=Array.from(n);t<r.length;t++)for(var o=r[t],a=0,i=Array.from(o.patterns);a<i.length;a++){var c=i[a]+"";if(e.substr(0,c.length)===c)return o}};return{fromNumber:t,fromType:function(e){for(var t=0,r=Array.from(n);t<r.length;t++){var o=r[t];if(o.type===e)return o}},cardType:function(e){return e&&i(t(e),(function(e){return e.type}))||null},formatExpiry:function(e){var n=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/);if(!n)return"";var t=n[1]||"",r=n[2]||"",o=n[3]||"";return o.length>0?r=" / ":" /"===r?(t=t.substring(0,1),r=""):2===t.length||r.length>0?r=" / ":1!==t.length||["0","1"].includes(t)||(t="0".concat(t),r=" / "),t+r+o},formatCardNumber:function(e){e=e.replace(/\D/g,"");var n=t(e);if(!n)return e;var r=n.length[n.length.length-1];if(e=e.slice(0,r),n.format.global)return i(e.match(n.format),(function(e){return e.join(" ")}));var o=n.format.exec(e);return null!=o?(o.shift(),(o=$.grep(o,(function(e){return e}))).join(" ")):void 0},defaultFormat:e,defaultInputFormat:/(?:^|\s)(\d{4})$/,parseExpiry:function(e){null==e&&(e="");var n=a(Array.from(e.split(/[\s\/]+/,2)),2),t=n[0],r=n[1];if(2===(null!=r?r.length:void 0)&&/^\d+$/.test(r)){var o=(new Date).getFullYear();r=(o=o.toString().slice(0,2))+r}if(t=parseInt(t,10),r=parseInt(r,10),!isNaN(t)&&!isNaN(r))return{month:t,year:r}}}})),e.factory("ccFormat",["ccUtils","$filter",function(e,n){var t=function(e){return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")||!(null==i("undefined"!=typeof document&&null!==document?document.selection:void 0,(function(e){return e.createRange}))||!document.selection.createRange().text)},r=function(e,n){var t;try{t=n.prop("selectionStart")}catch(e){t=null}var r=n.val();if(n.val(e),null!==t&&n.is(":focus")){if(t===r.length&&(t=e.length),r!==e){var o=r.slice(t-1,+t+1||void 0),a=e.slice(t-1,+t+1||void 0),i=e[t];/\d/.test(i)&&o==="".concat(i," ")&&a===" ".concat(i)&&(t+=1)}return n.prop("selectionStart",t),n.prop("selectionEnd",t)}},o=function(e){null==e&&(e="");for(var n="",t=e.split(""),r=0,o=Array.from(t);r<o.length;r++){var a=o[r],i="０１２３４５６７８９".indexOf(a);i>-1&&(a="0123456789"[i]),n+=a}return n};return{hasTextSelected:t,replaceFullWidthChars:o,reFormatNumeric:function(e){var n=$(e.currentTarget);return setTimeout((function(){var e=n.val();return e=(e=o(e)).replace(/\D/g,""),r(e,n)}))},reFormatCardNumber:function(n){var t=$(n.currentTarget);return setTimeout((function(){var n=t.val();return n=o(n),n=e.formatCardNumber(n),r(n,t)}))},formatCardNumber:function(n){var t,r=String.fromCharCode(n.which);if(/^\d+$/.test(r)){var o=$(n.currentTarget),a=o.val(),i=e.fromNumber(a+r),c=(a.replace(/\D/g,"")+r).length,l=16;if(i&&(l=i.length[i.length.length-1]),!(c>=l||null!=o.prop("selectionStart")&&o.prop("selectionStart")!==a.length))return(t=i&&"amex"===i.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(a)?(n.preventDefault(),setTimeout((function(){return o.val(a+" "+r)}))):t.test(a+r)?(n.preventDefault(),setTimeout((function(){return o.val(a+r+" ")}))):void 0}},formatBackCardNumber:function(e){var n=$(e.currentTarget),t=n.val();if(8===e.which&&(null==n.prop("selectionStart")||n.prop("selectionStart")===t.length))return/\d\s$/.test(t)?(e.preventDefault(),setTimeout((function(){return n.val(t.replace(/\d\s$/,""))}))):/\s\d?$/.test(t)?(e.preventDefault(),setTimeout((function(){return n.val(t.replace(/\d$/,""))}))):void 0},getFormattedCardNumber:function(n){n=n.replace(/\D/g,"");var t=e.fromNumber(n);if(!t)return n;var r=t.length[t.length.length-1];if(n=n.slice(0,r),t.format.global)return i(n.match(t.format),(function(e){return e.join(" ")}));var o=t.format.exec(n);return null!=o?(o.shift(),(o=$.grep(o,(function(e){return e}))).join(" ")):void 0},parseCardNumber:function(e){return null!=e?e.replace(/\s/g,""):e},reFormatExpiry:function(n){var t=$(n.currentTarget);return setTimeout((function(){var n=t.val();return n=o(n),n=e.formatExpiry(n),r(n,t)}))},formatExpiry:function(e){var n=String.fromCharCode(e.which);if(/^\d+$/.test(n)){var t=$(e.currentTarget),r=t.val()+n;return/^\d$/.test(r)&&!["0","1"].includes(r)?(e.preventDefault(),setTimeout((function(){return t.val("0".concat(r," / "))}))):/^\d\d$/.test(r)?(e.preventDefault(),setTimeout((function(){var e=parseInt(r[0],10),n=parseInt(r[1],10);return n>2&&0!==e?t.val("0".concat(e," / ").concat(n)):t.val("".concat(r," / "))}))):void 0}},formatForwardExpiry:function(e){var n=String.fromCharCode(e.which);if(/^\d+$/.test(n)){var t=$(e.currentTarget),r=t.val();return/^\d\d$/.test(r)?t.val("".concat(r," / ")):void 0}},formatForwardSlash:function(e){var n=String.fromCharCode(e.which);if("/"===n||" "===n){var t=$(e.currentTarget),r=t.val();return/^\d$/.test(r)&&"0"!==r?t.val("0".concat(r," / ")):void 0}},formatBackExpiry:function(e){var n=$(e.currentTarget),t=n.val();if(8===e.which&&(null==n.prop("selectionStart")||n.prop("selectionStart")===t.length))return/\d\s\/\s$/.test(t)?(e.preventDefault(),setTimeout((function(){return n.val(t.replace(/\d\s\/\s$/,""))}))):void 0},parseExpiry:function(t){if(null!=t){var r=e.parseExpiry(t);if(null==r)return;var o=new Date(r.year,r.month-1);return n("date")(o,"MM/yyyy")}},reFormatCVC:function(e){var n=$(e.currentTarget);return setTimeout((function(){var e=n.val();return e=(e=o(e)).replace(/\D/g,"").slice(0,4),r(e,n)}))},restrictNumeric:function(e){if(e.metaKey||e.ctrlKey)return!0;if(32===e.which)return!1;if(0===e.which)return!0;if(e.which<33)return!0;var n=String.fromCharCode(e.which);return!!/[\d\s]/.test(n)},restrictCardNumber:function(n){var r=$(n.currentTarget),o=String.fromCharCode(n.which);if(/^\d+$/.test(o)&&!t(r)){var a=(r.val()+o).replace(/\D/g,""),i=e.fromNumber(a);return i?a.length<=i.length[i.length.length-1]:a.length<=16}},restrictExpiry:function(e){var n=$(e.currentTarget),r=String.fromCharCode(e.which);if(/^\d+$/.test(r)&&!t(n)){var o=n.val()+r;return!((o=o.replace(/\D/g,"")).length>6)&&void 0}},restrictCVC:function(e){var n=$(e.currentTarget),r=String.fromCharCode(e.which);if(/^\d+$/.test(r)&&!t(n))return(n.val()+r).length<=4},setCardType:function(n){var t=$(n.currentTarget),r=t.val(),o=e.cardType(r)||"unknown";if(!t.hasClass(o)){var a=Array.from(cards).map((function(e){return e.type}));return t.removeClass("unknown"),t.removeClass(a.join(" ")),t.addClass(o),t.toggleClass("identified","unknown"!==o),t.trigger("payment.cardType",o)}}}}]),e.directive("ccFormatExpiry",["ccFormat",function(e){return{restrict:"A",require:"ngModel",link:function(n,t,r,o){return t.on("keypress",e.restrictNumeric),t.on("keypress",e.restrictExpiry),t.on("keypress",e.formatExpiry),t.on("keypress",e.formatForwardSlash),t.on("keypress",e.formatForwardExpiry),t.on("keydown",e.formatBackExpiry),t.on("change",e.reFormatExpiry),t.on("input",e.reFormatExpiry),t.on("paste",e.reFormatExpiry),o.$parsers.push(e.parseExpiry),o.$formatters.push(e.parseExpiry)}}}]),e.directive("ccFormatCardNumber",["ccFormat",function(e){return{restrict:"A",require:"ngModel",link:function(n,t,r,o){return t.on("keypress",e.restrictNumeric),t.on("keypress",e.restrictCardNumber),t.on("keypress",e.formatCardNumber),t.on("keydown",e.formatBackCardNumber),t.on("paste",e.reFormatCardNumber),o.$parsers.push(e.parseCardNumber),o.$formatters.push(e.getFormattedCardNumber)}}}]),e.directive("ccFormatSecCode",["ccFormat",function(e){return{restrict:"A",require:"ngModel",link:function(n,t,r,o){return t.on("keypress",e.restrictNumeric),t.on("keypress",e.restrictCVC),t.on("paste",e.reFormatCVC),t.on("change",e.reFormatCVC),t.on("input",e.reFormatCVC)}}}])}.apply(n,r))||(e.exports=o)},,,,,,,,,function(e,n,t){var r,o;r=[t(0),t(11)],void 0===(o=function(e,n){return e.controller("AdminGraphController",["$scope","$timeout","$location","$modal",function(e,t,r,o){e.user=window.data.user,e.user.gravatar=n(e.user.email).toString();var a=r.absUrl();return e.level=a.substr(a.indexOf("level=")+6,1),e.config={graph:window.data.graph,container:"graph",type:"canvas",settings:{defaultNodeColor:"#ccc",edgeColor:"target",edgeLabelSize:"proportional",enableEdgeHovering:!0,edgeHoverColor:"edge",edgeHoverSizeRatio:3}},sigma.renderers.def=sigma.renderers.canvas,e.sGraph=new sigma(e.config),e.sGraph.startForceAtlas2({worker:!0,barnesHutOptimize:!1}),e.sGraph.refresh(),e.sGraph.bind("clickNode",(function(n){return e.selectedElement={name:n.data.node.label,id:n.data.node.id,type:"User",link:"/admin/user/".concat(n.data.node.id)},e.openGraphModal()})),e.sGraph.bind("clickEdge",(function(n){return e.selectedElement={name:n.data.edge.label,id:n.data.edge.projectId,type:"Project",link:"/admin/project/".concat(n.data.edge.projectId)},e.openGraphModal()})),t((function(){return e.sGraph.stopForceAtlas2()}),500),e.openGraphModal=function(){return o.open({templateUrl:"graphModalTemplate",controller:"GraphModalController",resolve:{element:function(){return e.selectedElement}}})}}]),e.controller("GraphModalController",["$scope","$modalInstance","element",function(e,n,t){return e.element=t,e.close=function(){return n.close()}}])}.apply(n,r))||(e.exports=o)},,,,,,,,,,,,,,,,,,function(e,n,t){var r,o;r=[t(142),t(191),t(192),t(60),t(193),t(194),t(195),t(196),t(61),t(197),t(198),t(199),t(200),t(201),t(202),t(203),t(204),t(205),t(206),t(207),t(64),t(227),t(228),t(229),t(230),t(231),t(232),t(65),t(233),t(234),t(235),t(66),t(67),t(236),t(237),t(68),t(69),t(238),t(239),t(114),t(240),t(38),t(70),t(71),t(72),t(241),t(242)],void 0===(o=function(){return angular.module("SharelatexApp").config(["$locationProvider",function(e){try{return e.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}catch(e){return console.error("Error while trying to fix '#' links: ",e)}}]),angular.bootstrap(document.body,["SharelatexApp"])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(143),t(187),t(188),t(189),t(190),t(38)],void 0===(o=function(){}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(186)],void 0===(o=function(e){e.controller("ProjectPageController",["$scope","$modal","$window","queuedHttp","eventTracking","$timeout","localStorage","ProjectListService",function(e,n,t,r,o,a,i,c){e.projects=window.data.projects,e.tags=window.data.tags,e.notifications=window.data.notifications,e.notificationsInstitution=window.data.notificationsInstitution,e.allSelected=!1,e.selectedProjects=[],e.filter="all",e.predicate="lastUpdated",e.nUntagged=0,e.reverse=!0,e.searchText={value:""},e.$watch("predicate",(function(n){e.comparator="ownerName"===n?u:s})),a((function(){return l()}),10),e.$watch((function(){return e.projects.filter((function(e){return(null==e.tags||0===e.tags.length)&&!e.archived})).length}),(function(n){return e.nUntagged=n}));var l=function(){var n=$(".project-list-card");if(n&&n.offset()){var r=n.offset().top,o=n.outerHeight()-n.height(),a=$("footer").outerHeight(),i=t.innerHeight-r-a-o;e.projectListHeight=i}};function s(n,t){var r=0,o=n.type,a=t.type;if("ownerName"!==e.predicate){if(o===a){var i=n.value,c=t.value;"string"===o?(i=i.toLowerCase(),c=c.toLowerCase()):"object"===o&&(angular.isObject(i)&&(i=n.index),angular.isObject(c)&&(c=t.index)),i!==c&&(r=i<c?-1:1)}else r=o<a?-1:1;return r}}function u(n,t){if("ownerName"===e.predicate)return"You"===n.value?"You"===t.value&&n.index<t.index?-1:1:"An Overleaf v1 User"===n.value||"None"===n.value?"An Overleaf v1 User"===t.value||"None"===t.value?n.index<t.index?-1:1:-1:"You"===t.value?-1:"An Overleaf v1 User"===t.value||"None"===t.value?1:n.value>t.value?-1:1}angular.element(t).bind("resize",(function(){l(),e.$apply()})),e.$on("project-list:notifications-received",(function(){return e.$applyAsync((function(){return l()}))}));var d={},f=!0,p=!1,m=void 0;try{for(var h,g=e.projects[Symbol.iterator]();!(f=(h=g.next()).done);f=!0){var v=h.value;d[v.id]=v}}catch(e){p=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw m}}e.getProjectById=function(e){return d[e]};var y=!0,w=!1,b=void 0;try{for(var S,C=e.tags[Symbol.iterator]();!(y=(S=C.next()).done);y=!0){var T=S.value,P=!0,k=!1,j=void 0;try{for(var M,E=(T.project_ids||[])[Symbol.iterator]();!(P=(M=E.next()).done);P=!0){var x=M.value,I=d[x];I&&(I.tags||(I.tags=[]),I.tags.push(T))}}catch(e){k=!0,j=e}finally{try{P||null==E.return||E.return()}finally{if(k)throw j}}}}catch(e){w=!0,b=e}finally{try{y||null==C.return||C.return()}finally{if(w)throw b}}e.changePredicate=function(n){e.predicate===n&&(e.reverse=!e.reverse),e.predicate=n},e.getSortIconClass=function(n){return n===e.predicate&&e.reverse?"fa-caret-down":n!==e.predicate||e.reverse?"":"fa-caret-up"},e.searchProjects=function(){o.send("project-list-page-interaction","project-search","keydown"),e.updateVisibleProjects()},e.clearSearchText=function(){e.searchText.value="",e.filter="all",e.$emit("search:clear"),e.updateVisibleProjects()},e.setFilter=function(n){e.filter=n,e.updateVisibleProjects()},e.updateSelectedProjects=function(){e.selectedProjects=e.projects.filter((function(e){return e.selected}))},e.getSelectedProjects=function(){return e.selectedProjects},e.getSelectedProjectIds=function(){return e.selectedProjects.map((function(e){return e.id}))},e.getFirstSelectedProject=function(){return e.selectedProjects[0]},e.hasLeavableProjectsSelected=function(){return _.some(e.getSelectedProjects(),(function(e){return"owner"!==e.accessLevel&&e.trashed}))},e.hasDeletableProjectsSelected=function(){return _.some(e.getSelectedProjects(),(function(e){return"owner"===e.accessLevel&&e.trashed}))},e.updateVisibleProjects=function(){e.visibleProjects=[];var n=e.getSelectedTag(),t=!0,r=!1,o=void 0;try{for(var a,c=e.projects[Symbol.iterator]();!(t=(a=c.next()).done);t=!0){var l=a.value,s=!0;""!==e.searchText.value&&-1===l.name.toLowerCase().indexOf(e.searchText.value.toLowerCase())&&(s=!1),"tag"!==e.filter||null==n||n.project_ids.includes(l.id)||(s=!1),"untagged"===e.filter&&(null!=l.tags?l.tags.length:void 0)>0&&(s=!1),"shared"===e.filter&&"owner"===l.accessLevel&&(s=!1),"shared"===e.filter&&l.isV1Project&&(s=!1),"owned"===e.filter&&"owner"!==l.accessLevel&&(s=!1),"archived"===e.filter?l.archived||(s=!1):l.archived&&(s=!1),"trashed"===e.filter?l.trashed||(s=!1):l.trashed&&(s=!1),"v1"!==e.filter||l.isV1Project||(s=!1),s?e.visibleProjects.push(l):l.selected=!1}}catch(e){r=!0,o=e}finally{try{t||null==c.return||c.return()}finally{if(r)throw o}}i("project_list",JSON.stringify({filter:e.filter,selectedTagId:null!=n?n._id:void 0})),e.updateSelectedProjects()},e.getSelectedTag=function(){var n=!0,t=!1,r=void 0;try{for(var o,a=e.tags[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var i=o.value;if(i.selected)return i}}catch(e){t=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(t)throw r}}return null},e._removeProjectIdsFromTagArray=function(e,n){var t=[],r=[],o=!0,a=!1,i=void 0;try{for(var c,l=e.project_ids[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var s=c.value;n.includes(s)?r.push(s):t.push(s)}}catch(e){a=!0,i=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw i}}return e.project_ids=t,r},e._removeProjectFromList=function(n){var t=e.projects.indexOf(n);t>-1&&e.projects.splice(t,1)},e.removeSelectedProjectsFromTag=function(n){n.showWhenEmpty=!0;var t=e.getSelectedProjectIds(),o=e.getSelectedProjects(),a=e._removeProjectIdsFromTagArray(n,t),i=!0,c=!1,l=void 0;try{for(var s,u=o[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var d=s.value;d.tags||(d.tags=[]);var f=d.tags.indexOf(n);f>-1&&d.tags.splice(f,1)}}catch(e){c=!0,l=e}finally{try{i||null==u.return||u.return()}finally{if(c)throw l}}var p=!0,m=!1,h=void 0;try{for(var g,v=a[Symbol.iterator]();!(p=(g=v.next()).done);p=!0){var y=g.value;r({method:"DELETE",url:"/tag/".concat(n._id,"/project/").concat(y),headers:{"X-CSRF-Token":window.csrfToken}})}}catch(e){m=!0,h=e}finally{try{p||null==v.return||v.return()}finally{if(m)throw h}}e.updateVisibleProjects()},e.removeProjectFromTag=function(n,t){t.showWhenEmpty=!0,n.tags||(n.tags=[]);var o=n.tags.indexOf(t);o>-1&&(e._removeProjectIdsFromTagArray(t,[n.id]),n.tags.splice(o,1),r({method:"DELETE",url:"/tag/".concat(t._id,"/project/").concat(n.id),headers:{"X-CSRF-Token":window.csrfToken}}),e.updateVisibleProjects())},e.addSelectedProjectsToTag=function(n){var t=e.getSelectedProjects();o.send("project-list-page-interaction","project action","addSelectedProjectsToTag");var a=[],i=!0,c=!1,l=void 0;try{for(var s,u=e.getSelectedProjectIds()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var d=s.value;n.project_ids.includes(d)||(n.project_ids.push(d),a.push(d))}}catch(e){c=!0,l=e}finally{try{i||null==u.return||u.return()}finally{if(c)throw l}}var f=!0,p=!1,m=void 0;try{for(var h,g=t[Symbol.iterator]();!(f=(h=g.next()).done);f=!0){var v=h.value;v.tags||(v.tags=[]),v.tags.includes(n)||v.tags.push(n)}}catch(e){p=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw m}}for(var y=0,w=a;y<w.length;y++){var b=w[y];r.post("/tag/".concat(n._id,"/project/").concat(b),{_csrf:window.csrfToken})}},e.openNewTagModal=function(t){n.open({templateUrl:"newTagModalTemplate",controller:"NewTagModalController"}).result.then((function(n){e.tags.find((function(e){return n.name===e.name}))||(e.tags.push(n),e.addSelectedProjectsToTag(n))}))},e.createProject=function(n,t){return null==t&&(t="none"),r.post("/project/new",{_csrf:window.csrfToken,projectName:n,template:t}).then((function(t){var r=t.data;e.projects.push({name:n,_id:r.project_id,accessLevel:"owner",owner:{_id:window.user_id}}),e.updateVisibleProjects()}))},e.openCreateProjectModal=function(t){null==t&&(t="none"),o.send("project-list-page-interaction","new-project",t),n.open({templateUrl:"newProjectModalTemplate",controller:"NewProjectModalController",resolve:{template:function(){return t}},scope:e}).result.then((function(e){return window.location="/project/".concat(e)}))},e.renameProject=function(e,n){return r.post("/project/".concat(e.id,"/rename"),{newProjectName:n,_csrf:window.csrfToken}).then((function(){return e.name=n}))},e.openRenameProjectModal=function(){var t=e.getFirstSelectedProject();t&&"owner"===t.accessLevel&&(o.send("project-list-page-interaction","project action","Rename"),n.open({templateUrl:"renameProjectModalTemplate",controller:"RenameProjectModalController",resolve:{project:function(){return t}},scope:e}))},e.cloneProject=function(n,t){return o.send("project-list-page-interaction","project action","Clone"),r.post("/project/".concat(n.id,"/clone"),{_csrf:window.csrfToken,projectName:t}).then((function(n){var t=n.data;e.projects.push({name:t.name,id:t.project_id,accessLevel:"owner",owner:{_id:t.owner_ref}}),e.updateVisibleProjects()}))},e.openCloneProjectModal=function(){var t=e.getFirstSelectedProject();t&&n.open({templateUrl:"cloneProjectModalTemplate",controller:"CloneProjectModalController",resolve:{project:function(){return t}},scope:e})};var A=function(e,t){return o.send("project-list-page-interaction","project action",e),n.open({templateUrl:"archiveTrashLeaveOrDeleteProjectsModalTemplate",controller:"ArchiveTrashLeaveOrDeleteProjectsModalController",resolve:{projects:function(){return t},action:function(){return e}}})};e.createArchiveProjectsModal=function(e){return A("archive",e)},e.createTrashProjectsModal=function(e){return A("trash",e)},e.createLeaveProjectsModal=function(e){return A("leave",e)},e.createDeleteProjectsModal=function(e){return A("delete",e)},e.createLeaveOrDeleteProjectsModal=function(e){return A("leaveOrDelete",e)},e.openArchiveProjectsModal=function(){e.createArchiveProjectsModal(e.getSelectedProjects()).result.then((function(){return e.archiveSelectedProjects()}))},e.openTrashProjectsModal=function(){e.createTrashProjectsModal(e.getSelectedProjects()).result.then((function(){return e.trashSelectedProjects()}))},e.openLeaveProjectsModal=function(){e.createLeaveProjectsModal(e.getSelectedProjects()).result.then((function(){return e.leaveSelectedProjects()}))},e.openDeleteProjectsModal=function(){e.createDeleteProjectsModal(e.getSelectedProjects()).result.then((function(){return e.deleteSelectedProjects()}))},e.openLeaveOrDeleteProjectsModal=function(){e.createLeaveOrDeleteProjectsModal(e.getSelectedProjects()).result.then((function(){return e.leaveOrDeleteSelectedProjects()}))},e.archiveSelectedProjects=function(){return e.archiveProjects(e.getSelectedProjects())},e.unarchiveSelectedProjects=function(){return e.unarchiveProjects(e.getSelectedProjects())},e.trashSelectedProjects=function(){return e.trashProjects(e.getSelectedProjects())},e.untrashSelectedProjects=function(){return e.untrashProjects(e.getSelectedProjects())},e.leaveSelectedProjects=function(){return e.leaveProjects(e.getSelectedProjects())},e.deleteSelectedProjects=function(){return e.deleteProjects(e.getSelectedProjects())},e.leaveOrDeleteSelectedProjects=function(){return e.leaveOrDeleteProjects(e.getSelectedProjects())},e.archiveProjects=function(n){var t=!0,r=!1,o=void 0;try{for(var a,i=n[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;c.archived=!0,c.trashed=!1,U(c)}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}e.updateVisibleProjects()},e.unarchiveProjects=function(n){var t=!0,r=!1,o=void 0;try{for(var a,i=n[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;c.archived=!1,D(c)}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}e.updateVisibleProjects()},e.trashProjects=function(n){var t=!0,r=!1,o=void 0;try{for(var a,i=n[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;c.trashed=!0,c.archived=!1,F(c)}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}e.updateVisibleProjects()},e.untrashProjects=function(n){var t=!0,r=!1,o=void 0;try{for(var a,i=n[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;c.trashed=!1,N(c)}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}e.updateVisibleProjects()},e.leaveProjects=function(n){R(n);var t=!0,r=!1,o=void 0;try{for(var a,i=n[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;L(c)}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}e.updateVisibleProjects()},e.deleteProjects=function(n){R(n);var t=!0,r=!1,o=void 0;try{for(var a,i=n[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;O(c)}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}e.updateVisibleProjects()},e.leaveOrDeleteProjects=function(n){R(n);var t=!0,r=!1,o=void 0;try{for(var a,i=n[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;"owner"===c.accessLevel?O(c):L(c)}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}e.updateVisibleProjects()};var U=function(e){return r({method:"POST",url:"/project/".concat(e.id,"/archive"),headers:{"X-CSRF-Token":window.csrfToken}})},D=function(e){return r({method:"DELETE",url:"/project/".concat(e.id,"/archive"),headers:{"X-CSRF-Token":window.csrfToken}})},F=function(e){return r({method:"POST",url:"/project/".concat(e.id,"/trash"),headers:{"X-CSRF-Token":window.csrfToken}})},N=function(e){return r({method:"DELETE",url:"/project/".concat(e.id,"/trash"),headers:{"X-CSRF-Token":window.csrfToken}})},L=function(e){return r({method:"POST",url:"/project/".concat(e.id,"/leave"),headers:{"X-CSRF-Token":window.csrfToken}})},O=function(e){return r({method:"DELETE",url:"/project/".concat(e.id,"?forever=true"),headers:{"X-CSRF-Token":window.csrfToken}})},R=function(n){var t=n.map((function(e){return e.id})),r=!0,o=!1,a=void 0;try{for(var i,c=(e.tags||[])[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var l=i.value;e._removeProjectIdsFromTagArray(l,t)}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}var s=!0,u=!1,d=void 0;try{for(var f,p=(n||[])[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var m=f.value;e._removeProjectFromList(m)}}catch(e){u=!0,d=e}finally{try{s||null==p.return||p.return()}finally{if(u)throw d}}};e.getValueForCurrentPredicate=function(n){return"ownerName"===e.predicate?c.getOwnerName(n):n[e.predicate]},e.openUploadProjectModal=function(){n.open({templateUrl:"uploadProjectModalTemplate",controller:"UploadProjectModalController"})},e.downloadSelectedProjects=function(){return e.downloadProjectsById(e.getSelectedProjectIds())},e.downloadProjectsById=function(e){var n;return o.send("project-list-page-interaction","project action","Download Zip"),n=e.length>1?"/project/download/zip?project_ids=".concat(e.join(",")):"/project/".concat(e[0],"/download/zip"),window.location=n};var B=JSON.parse(i("project_list"));B&&B.filter?("tag"===B.filter&&B.selectedTagId&&function(n){var t=!0,r=!1,o=void 0;try{for(var a,i=e.tags[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;c._id===n?c.selected=!0:c.selected=!1}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}}(B.selectedTagId),e.setFilter(B.filter)):e.updateVisibleProjects()}]),e.controller("ProjectListItemController",["$scope","$modal","queuedHttp","ProjectListService",function(e,n,t,r){e.projectLink=function(e){return"readAndWrite"===e.accessLevel&&"token"===e.source?"/".concat(e.tokens.readAndWrite):"readOnly"===e.accessLevel&&"token"===e.source?"/read/".concat(e.tokens.readOnly):"/project/".concat(e.id)},e.isLinkSharingProject=function(e){return"token"===e.source},e.hasGenericOwnerName=function(){var n=e.project.owner,t=n.first_name,r=n.last_name,o=n.email;return!t&&!r&&!o},e.getOwnerName=r.getOwnerName,e.getUserName=r.getUserName,e.isOwner=function(){return e.project.owner&&window.user_id===e.project.owner._id},e.$watch("project.selected",(function(n){null!=n&&e.updateSelectedProjects()})),e.clone=function(t){return t.stopPropagation(),e.project.isTableActionInflight=!0,e.cloneProject(e.project,"".concat(e.project.name," (Copy)")).then((function(){return e.project.isTableActionInflight=!1})).catch((function(t){var r=t.data,o=400!==t.status||{message:r};n.open({templateUrl:"showErrorModalTemplate",controller:"ShowErrorModalController",resolve:{error:function(){return o}}}),e.project.isTableActionInflight=!1}))},e.download=function(n){n.stopPropagation(),e.downloadProjectsById([e.project.id])},e.archive=function(n){n.stopPropagation(),e.createArchiveProjectsModal([e.project]).result.then((function(){e.archiveProjects([e.project])}))},e.unarchive=function(n){n.stopPropagation(),e.unarchiveProjects([e.project])},e.trash=function(n){n.stopPropagation(),e.createTrashProjectsModal([e.project]).result.then((function(){e.trashProjects([e.project])}))},e.untrash=function(n){n.stopPropagation(),e.untrashProjects([e.project])},e.leave=function(n){n.stopPropagation(),e.createLeaveProjectsModal([e.project]).result.then((function(){e.leaveProjects([e.project])}))},e.delete=function(n){n.stopPropagation(),e.createDeleteProjectsModal([e.project]).result.then((function(){e.deleteProjects([e.project])}))}}])}.apply(n,r))||(e.exports=o)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.service("ProjectListService",(function(){return{getOwnerName:function(e){return"owner"===e.accessLevel?"You":null!=e.owner?this.getUserName(e.owner):"None"},getUserName:function(e){if(e&&e._id===window.user_id)return"You";if(e){var n=e.first_name,t=e.last_name,r=e.email;return n||t?[n,t].filter((function(e){return null!=e})).join(" "):r||"An Overleaf v1 User"}return"None"}}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("RenameProjectModalController",["$scope","$modalInstance","$timeout","project","queuedHttp",function(e,n,t,r,o){return e.inputs={projectName:r.name},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.rename=function(){return e.state.inflight=!0,e.state.error=!1,e.renameProject(r,e.inputs.projectName).then((function(){return e.state.inflight=!1,e.state.error=!1,n.close()})).catch((function(n){var t=n.data,r=n.status;return e.state.inflight=!1,e.state.error=400!==r||{message:t}}))},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("CloneProjectModalController",["$scope","$modalInstance","$timeout","project",function(e,n,t,r){return e.inputs={projectName:r.name+" (Copy)"},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.clone=function(){return e.state.inflight=!0,e.cloneProject(r,e.inputs.projectName).then((function(){return e.state.inflight=!1,e.state.error=!1,n.close()})).catch((function(n){var t=n.data,r=n.status;return e.state.inflight=!1,e.state.error=400!==r||{message:t}}))},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("NewProjectModalController",["$scope","$modalInstance","$timeout","template",function(e,n,t,r){return e.inputs={projectName:""},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.create=function(){return e.state.inflight=!0,e.state.error=!1,e.createProject(e.inputs.projectName,r).then((function(t){var r=t.data;return e.state.inflight=!1,e.state.error=!1,n.close(r.project_id)})).catch((function(n){var t=n.data,r=n.status;return e.state.inflight=!1,e.state.error=400!==r||{message:t}}))},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("ArchiveTrashLeaveOrDeleteProjectsModalController",["$scope","$modalInstance","$timeout","projects","action",function(e,n,t,r,o){e.projects=r,e.action=o,e.confirm=function(){return n.close({projects:r,action:o})},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("UploadProjectModalController",["$scope","$modalInstance","$timeout",function(e,n,t){return e.cancel=function(){return n.dismiss("cancel")},e.onComplete=function(e,n,t){if(null!=t.project_id)return window.location="/project/".concat(t.project_id)}}]),e.controller("V1ImportModalController",["$scope","$modalInstance","project",function(e,n,t){return e.project=t,e.dismiss=function(){return n.dismiss("cancel")}}]),e.controller("ShowErrorModalController",["$scope","$modalInstance","error",function(e,n,t){return e.error=t,e.cancel=function(){return n.dismiss("cancel")}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(9)],void 0===(o=function(e,n){return e.controller("TagListController",["$scope","$modal",function(e,t){e.filterProjects=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";e._clearTags(),e.setFilter(n)},e._clearTags=function(){return e.tags.forEach((function(e){e.selected=!1}))},e.selectTag=function(n){e._clearTags(),n.selected=!0,e.setFilter("tag")},e.selectUntagged=function(){e._clearTags(),e.setFilter("untagged")},e.countProjectsForTag=function(n){return n.project_ids.reduce((function(n,t){var r=e.getProjectById(t);return r?r.archived?n:n+1:n}),0)},e.getHueForTagId=function(e){return n.getHueForTagId(e)},e.deleteTag=function(n){t.open({templateUrl:"deleteTagModalTemplate",controller:"DeleteTagModalController",resolve:{tag:function(){return n}}}).result.then((function(){var t=!0,r=!1,o=void 0;try{for(var a,i=e.projects[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;c.tags||(c.tags=[]);var l=c.tags.indexOf(n);l>-1&&c.tags.splice(l,1)}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}e.tags=e.tags.filter((function(e){return e!==n}))}))},e.renameTag=function(e){t.open({templateUrl:"renameTagModalTemplate",controller:"RenameTagModalController",resolve:{tag:function(){return e}}}).result.then((function(n){return e.name=n}))}}]),e.controller("TagDropdownItemController",["$scope",function(e){e.recalculateProjectsInTag=function(){var n;e.areSelectedProjectsInTag=!1;var t=!0,r=!1,o=void 0;try{for(var a,i=e.getSelectedProjectIds()[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var c=a.value;e.tag.project_ids.includes(c)?e.areSelectedProjectsInTag=!0:n=!0}}catch(e){r=!0,o=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw o}}e.areSelectedProjectsInTag&&n&&(e.areSelectedProjectsInTag="partial")},e.addOrRemoveProjectsFromTag=function(){!0===e.areSelectedProjectsInTag?(e.removeSelectedProjectsFromTag(e.tag),e.areSelectedProjectsInTag=!1):!1!==e.areSelectedProjectsInTag&&"partial"!==e.areSelectedProjectsInTag||(e.addSelectedProjectsToTag(e.tag),e.areSelectedProjectsInTag=!0)},e.$watch("selectedProjects",(function(){return e.recalculateProjectsInTag()})),e.recalculateProjectsInTag()}]),e.controller("NewTagModalController",["$scope","$modalInstance","$timeout","$http",function(e,n,t,r){e.inputs={newTagName:""},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.create=function(){var t=e.inputs.newTagName;e.state.inflight=!0,e.state.error=!1,r.post("/tag",{_csrf:window.csrfToken,name:t}).then((function(t){var r=t.data;e.state.inflight=!1,n.close(r)})).catch((function(){e.state.inflight=!1,e.state.error=!0}))},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("RenameTagModalController",["$scope","$modalInstance","$timeout","$http","tag",function(e,n,t,r,o){e.inputs={tagName:o.name},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.rename=function(){var t=e.inputs.tagName;return e.state.inflight=!0,e.state.error=!1,r.post("/tag/".concat(o._id,"/rename"),{_csrf:window.csrfToken,name:t}).then((function(){e.state.inflight=!1,n.close(t)})).catch((function(){e.state.inflight=!1,e.state.error=!0}))},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("DeleteTagModalController",["$scope","$modalInstance","$http","tag",function(e,n,t,r){e.tag=r,e.state={inflight:!1,error:!1},e.delete=function(){return e.state.inflight=!0,e.state.error=!1,t({method:"DELETE",url:"/tag/".concat(r._id),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.state.inflight=!1,n.close()})).catch((function(){e.state.inflight=!1,e.state.error=!0}))},e.cancel=function(){return n.dismiss("cancel")}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("NotificationsController",["$scope","$http",function(e,n){for(var t=0,r=Array.from(e.notifications);t<r.length;t++){r[t].hide=!1}return e.samlInitPath=ExposedSettings.samlInitPath,e.dismiss=function(e){return n({url:"/notifications/".concat(e._id),method:"DELETE",headers:{"X-Csrf-Token":window.csrfToken}}).then((function(){return e.hide=!0}))}}]),e.controller("ProjectInviteNotificationController",["$scope","$http",function(e,n){return e.projectName=e.notification.messageOpts.projectName,e.userName=e.notification.messageOpts.userName,e.accept=function(){return e.notification.inflight=!0,n({url:"/project/".concat(e.notification.messageOpts.projectId,"/invite/token/").concat(e.notification.messageOpts.token,"/accept"),method:"POST",headers:{"X-Csrf-Token":window.csrfToken,"X-Requested-With":"XMLHttpRequest"}}).then((function(){e.notification.accepted=!0})).catch((function(n){404===n.status?e.notification.accepted=!0:e.notification.error=!0})).finally((function(){e.notification.inflight=!1}))}}]),e.controller("OverleafV2NotificationController",["$scope","localStorage",function(e,n){return e.visible=!n("overleaf_v2_2_notification_hidden_at"),e.dismiss=function(){return e.visible=!1,n("overleaf_v2_2_notification_hidden_at",Date.now())}}]),e.controller("OverleafV1NotificationController",["$scope","localStorage",function(e,n){return e.visible=!n("overleaf_v1_notification_hidden_at"),e.toggle=function(){return e.visible=!e.visible,e.visible?n("overleaf_v1_notification_hidden_at",null):n("overleaf_v1_notification_hidden_at",Date.now())}}]),e.controller("EmailNotificationController",["$scope","$http","UserAffiliationsDataService",function(e,n,t){e.userEmails=[];e.showConfirmEmail=function(e){return!ExposedSettings.emailConfirmationDisabled&&(!e.confirmedAt&&!e.hide&&!function(e){return!!ExposedSettings.hasSamlFeature&&(!(!e.affiliation||!e.affiliation.institution)&&(!!e.affiliation.institution.ssoEnabled||!(!ExposedSettings.hasSamlBeta||!e.affiliation.institution.ssoBeta)))}(e))};for(var r=0,o=Array.from(e.userEmails);r<o.length;r++){o[r].hide=!1}return t.getUserEmails().then((function(n){return e.userEmails=n,e.$emit("project-list:notifications-received")})),e.resendConfirmationEmail=function(n){return n.confirmationInflight=!0,t.resendConfirmationEmail(n.email).then((function(){return n.hide=!0,n.confirmationInflight=!1,e.$emit("project-list:notifications-received")}))}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("LeftHandMenuPromoController",["$scope","UserAffiliationsDataService","eventTracking",function(e,n,t){e.hasProjects=window.data.projects.length>0,e.userHasNoSubscription=window.userHasNoSubscription,e.upgradeSubscription=function(){t.send("subscription-funnel","project-page","upgrade")},e.share=function(){t.send("subscription-funnel","project-page","sharing")};e.userEmails=[],e.userAffiliations=[],n.getUserEmails().then((function(n){e.userEmails=n,e.userAffiliations=n.filter((function(e){return e.affiliation})).map((function(e){return e.affiliation})),e.userOnPayingUniversity=e.userAffiliations.some((function(e){return"free"!==e.institution.licence}))}))}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){e.controller("AccountSettingsController",["$scope","$http","$modal","eventTracking","UserAffiliationsDataService",function(e,n,t,r,o){e.subscribed=!0,e.unsubscribe=function(){return e.unsubscribing=!0,n({method:"DELETE",url:"/user/newsletter/unsubscribe",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.unsubscribing=!1,e.subscribed=!1})).catch((function(){return e.unsubscribing=!0}))},e.deleteAccount=function(){t.open({templateUrl:"deleteAccountModalTemplate",controller:"DeleteAccountModalController",resolve:{userDefaultEmail:function(){return o.getUserDefaultEmail().then((function(e){return(null!=e?e.email:void 0)||null})).catch((function(){return null}))}}})},e.upgradeIntegration=function(e){return r.send("subscription-funnel","settings-page",e)}}]),e.controller("DeleteAccountModalController",["$scope","$modalInstance","$timeout","$http","userDefaultEmail",function(e,n,t,r,o){e.state={isValid:!1,deleteText:"",password:"",confirmV1Purge:!1,confirmSharelatexDelete:!1,inflight:!1,error:null},e.userDefaultEmail=o,n.opened.then((function(){return t((function(){return e.$broadcast("open")}),700)})),e.checkValidation=function(){return e.state.isValid=null!=o&&e.state.deleteText.toLowerCase()===o.toLowerCase()&&e.state.password.length>0&&e.state.confirmV1Purge&&e.state.confirmSharelatexDelete},e.delete=function(){return e.state.inflight=!0,e.state.error=null,r({method:"POST",url:"/user/delete",headers:{"X-CSRF-Token":window.csrfToken,"Content-Type":"application/json"},data:{password:e.state.password},disableAutoLoginRedirect:!0}).then((function(){n.close(),e.state.inflight=!1,e.state.error=null,setTimeout((function(){return window.location="/login"}),1e3)})).catch((function(n){var t=n.data,r=n.status;e.state.inflight=!1,403===r?e.state.error={code:"InvalidCredentialsError"}:t.error?e.state.error={code:t.error}:e.state.error={code:"UserDeletionError"}}))},e.cancel=function(){return n.dismiss("cancel")}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("ClearSessionsController",["$scope","$http",function(e,n){return e.state={otherSessions:window.otherSessions,error:!1,success:!1},e.clearSessions=function(){return console.log(">> clearing all sessions"),n({method:"POST",url:"/user/sessions/clear",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return e.state.otherSessions=[],e.state.error=!1,e.state.success=!0})).catch((function(){return e.state.error=!0}))}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){e.factory("MultiCurrencyPricing",(function(){return{currencyCode:window.recomendedCurrency,plans:{USD:{symbol:"$",student:{monthly:"$8",annual:"$80"},collaborator:{monthly:"$15",annual:"$180"},professional:{monthly:"$30",annual:"$360"}},EUR:{symbol:"€",student:{monthly:"€7",annual:"€70"},collaborator:{monthly:"€14",annual:"€168"},professional:{monthly:"€28",annual:"€336"}},GBP:{symbol:"£",student:{monthly:"£6",annual:"£60"},collaborator:{monthly:"£12",annual:"£144"},professional:{monthly:"£24",annual:"£288"}},SEK:{symbol:"kr",student:{monthly:"60 kr",annual:"600 kr"},collaborator:{monthly:"110 kr",annual:"1320 kr"},professional:{monthly:"220 kr",annual:"2640 kr"}},CAD:{symbol:"$",student:{monthly:"$9",annual:"$90"},collaborator:{monthly:"$17",annual:"$204"},professional:{monthly:"$34",annual:"$408"}},NOK:{symbol:"kr",student:{monthly:"60 kr",annual:"600 kr"},collaborator:{monthly:"110 kr",annual:"1320 kr"},professional:{monthly:"220 kr",annual:"2640 kr"}},DKK:{symbol:"kr",student:{monthly:"50 kr",annual:"500 kr"},collaborator:{monthly:"90 kr",annual:"1080 kr"},professional:{monthly:"180 kr",annual:"2160 kr"}},AUD:{symbol:"$",student:{monthly:"$10",annual:"$100"},collaborator:{monthly:"$18",annual:"$216"},professional:{monthly:"$35",annual:"$420"}},NZD:{symbol:"$",student:{monthly:"$10",annual:"$100"},collaborator:{monthly:"$18",annual:"$216"},professional:{monthly:"$35",annual:"$420"}},CHF:{symbol:"Fr",student:{monthly:"Fr 8",annual:"Fr 80"},collaborator:{monthly:"Fr 15",annual:"Fr 180"},professional:{monthly:"Fr 30",annual:"Fr 360"}},SGD:{symbol:"$",student:{monthly:"$12",annual:"$120"},collaborator:{monthly:"$20",annual:"$240"},professional:{monthly:"$40",annual:"$480"}}}}})),e.controller("PlansController",["$scope","$modal","eventTracking","MultiCurrencyPricing","$http","$filter","ipCookie","$location",function(e,n,t,r,o,a,i,c){var l;e.showPlans=!0,e.plans=r.plans,e.currencyCode=r.currencyCode,e.trial_len=7,e.planQueryString="_free_trial_7_days",e.ui={view:"monthly"},e.changeCurreny=function(n,t){n.preventDefault(),e.currencyCode=t},e.getCollaboratorPlanCode=function(){return"annual"===e.ui.view?"collaborator-annual":"collaborator".concat(e.planQueryString)},e.signUpNowClicked=function(n,r){"annual"===e.ui.view&&(n="".concat(n,"_annual")),n=s(n,r),t.sendMB("plans-page-start-trial"),t.send("subscription-funnel","sign_up_now_button",n)},e.switchToMonthly=function(n,t){l(n,"monthly-prices",t),e.ui.view="monthly"},e.switchToStudent=function(n,t){l(n,"student-prices",t),e.ui.view="student"},e.switchToAnnual=function(n,t){l(n,"annual-prices",t),e.ui.view="annual"},e.openGroupPlanModal=function(){var e="".concat(window.location.pathname).concat(window.location.search);history.replaceState(null,document.title,e+"#groups"),n.open({templateUrl:"groupPlanModalPurchaseTemplate",controller:"GroupPlansModalPurchaseController"}).result.finally((function(){return history.replaceState(null,document.title,window.location.pathname)})),t.send("subscription-funnel","plans-page","group-inquiry-potential")},"groups"===c.hash()&&e.openGroupPlanModal(),e.openPayByInvoiceModal=function(){var e="".concat(window.location.pathname).concat(window.location.search);history.replaceState(null,document.title,e+"#pay-by-invoice"),n.open({templateUrl:"groupPlanModalInquiryTemplate"}).result.finally((function(){return history.replaceState(null,document.title,window.location.pathname)})),t.send("subscription-funnel","plans-page","group-inquiry-potential")},"pay-by-invoice"===c.hash()&&e.openPayByInvoiceModal();var s=function(e,n){return e};l=function(e,n,r){e.preventDefault();var o=s(n,r);t.send("subscription-funnel","plans-page",o)}}]),e.controller("GroupPlansModalPurchaseController",["$scope","$modal","$location",function(e,n,t){e.options={plan_codes:[{display:"Collaborator",code:"collaborator"},{display:"Professional",code:"professional"}],currencies:[{display:"USD ($)",code:"USD"},{display:"GBP (£)",code:"GBP"},{display:"EUR (€)",code:"EUR"}],currencySymbols:{USD:"$",EUR:"€",GBP:"£"},sizes:[2,3,4,5,10,20,50],usages:[{display:"Enterprise",code:"enterprise"},{display:"Educational",code:"educational"}]},e.prices=window.groupPlans;var r="USD";if(["USD","GBP","EUR"].includes(window.recomendedCurrency)&&(r=window.recomendedCurrency),e.selected={plan_code:"collaborator",currency:r,size:"10",usage:"educational"},t.search()){if(t.search().usage&&e.options.usages.forEach((function(n){n.code===t.search().usage&&(e.selected.usage=n.code)})),t.search().plan&&e.options.plan_codes.forEach((function(n){n.code===t.search().plan&&(e.selected.plan_code=n.code)})),t.search().number){var o=parseInt(t.search().number,10);-1!==e.options.sizes.indexOf(o)&&(e.selected.size=t.search().number)}t.search().currency&&e.options.currencies.forEach((function(n){n.code===t.search().currency&&(e.selected.currency=n.code)}))}e.recalculatePrice=function(){var n=e.selected,t=n.usage,r=n.plan_code,o=n.currency,a=n.size,i=e.prices[t][r][o][a],c=e.options.currencySymbols[o];e.displayPrice="".concat(c).concat(i)},e.$watch("selected",e.recalculatePrice,!0),e.recalculatePrice(),e.purchase=function(){var n=e.selected,t=n.plan_code,r=n.size,o=n.usage,a=n.currency;t="group_".concat(t,"_").concat(r,"_").concat(o),window.location="/user/subscription/new?planCode=".concat(t,"&currency=").concat(a,"&itm_campaign=groups")},e.payByInvoice=function(){n.open({templateUrl:"groupPlanModalInquiryTemplate"}),e.$close()}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("PostGatewayController",["$scope",function(e){e.handleGateway=function(){var e=JSON.parse($("#gateway-data").text()).params;e.viaGateway="true",Object.keys(e).forEach((function(n){$("<input>").attr({type:"hidden",name:n,value:e[n]}).appendTo("#gateway")})),$("#gateway").submit()}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("UserMembershipController",["$scope","queuedHttp",function(e,n){e.users=window.users,e.groupSize=window.groupSize,e.paths=window.paths,e.selectedUsers=[],e.inputs={addMembers:{content:"",error:!1,errorMessage:null,inflightCount:0},removeMembers:{error:!1,errorMessage:null}};return e.addMembers=function(){e.inputs.addMembers.error=!1,e.inputs.addMembers.errorMessage=null,e.inputs.addMembers.inflightCount=0;var t=function(e){var n=e.split(/[\s,]+/);return n=_.map(n,(function(e){return e.trim()})),n=_.filter(n,(function(e){return-1!==e.indexOf("@")}))}(e.inputs.addMembers.content);return Array.from(t).map((function(t){return e.inputs.addMembers.inflightCount+=1,n.post(paths.addMember,{email:t,_csrf:window.csrfToken}).then((function(n){e.inputs.addMembers.inflightCount-=1;var t=n.data;return null!=t.user&&e.users.push(t.user),e.inputs.addMembers.content=""})).catch((function(n){e.inputs.addMembers.inflightCount-=1;var t=n.data;return e.inputs.addMembers.error=!0,e.inputs.addMembers.errorMessage=null!=t.error?t.error.message:void 0}))}))},e.removeMembers=function(){e.inputs.removeMembers.error=!1,e.inputs.removeMembers.errorMessage=null;for(var t=0,r=Array.from(e.selectedUsers);t<r.length;t++){!function(t){var r;if(paths.removeInvite&&t.invite&&null==t._id)r="".concat(paths.removeInvite,"/").concat(encodeURIComponent(t.email));else{if(!paths.removeMember||null==t._id)return;r="".concat(paths.removeMember,"/").concat(t._id)}n({method:"DELETE",url:r,headers:{"X-Csrf-Token":window.csrfToken}}).then((function(){var n=e.users.indexOf(t);if(-1!==n)return e.users.splice(n,1)})).catch((function(n){var t=n.data;return e.inputs.removeMembers.error=!0,e.inputs.removeMembers.errorMessage=null!=t.error?t.error.message:void 0}))}(r[t])}return e.updateSelectedUsers},e.updateSelectedUsers=function(){return e.selectedUsers=e.users.filter((function(e){return e.selected}))}}]),e.controller("UserMembershipListItemController",["$scope",function(e){return e.$watch("user.selected",(function(n){if(null!=n)return e.updateSelectedUsers()}))}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("ScribtexPopupController",["$scope","$modal",function(e,n){return n.open({templateUrl:"scribtexModalTemplate"})}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("BonusLinksController",["$scope","$modal",function(e,n){return e.openLinkToUsModal=function(){return n.open({templateUrl:"BonusLinkToUsModal",controller:"BonusModalController"})}}]),e.controller("BonusModalController",["$scope","$modalInstance",function(e,n){return e.cancel=function(){return n.dismiss()}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("SystemMessagesController",["$scope",function(e){return e.messages=window.systemMessages}]),e.controller("SystemMessageController",["$scope","$sce",function(e,n){return e.hidden=$.localStorage("systemMessage.hide.".concat(e.message._id)),e.htmlContent=e.message.content,e.hide=function(){return e.hidden=!0,$.localStorage("systemMessage.hide.".concat(e.message._id),!0)}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("TranslationsPopupController",["$scope","ipCookie",function(e,n){return e.hidei18nNotification=n("hidei18nNotification"),e.dismiss=function(){return n("hidei18nNotification",!0,{expires:180}),e.hidei18nNotification=n("hidei18nNotification")}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){var n=_.once((function(){return!("undefined"==typeof recurly||!recurly)&&(recurly.configure(window.recurlyApiKey),!0)}));e.controller("MetricsEmailController",["$scope","$http",function(e,n){e.institutionEmailSubscription=function(e){return _.find(window.managedInstitutions,(function(n){return n.v1Id===parseInt(e)})).metricsEmail.optedOutUserIds.includes(window.user_id)?"Subscribe":"Unsubscribe"},e.changeInstitutionalEmailSubscription=function(t){return e.subscriptionChanging=!0,n({method:"POST",url:"/institutions/".concat(t,"/emailSubscription"),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(n){window.managedInstitutions=_.map(window.managedInstitutions,(function(e){return e.v1Id===parseInt(t)&&(e.metricsEmail.optedOutUserIds=n.data),e})),e.subscriptionChanging=!1}))}}]),e.factory("RecurlyPricing",["$q","MultiCurrencyPricing",function(e,t){return{loadDisplayPriceWithTax:function(r,o,a){if(n()){var i=t.plans[o].symbol,c=recurly.Pricing();return e((function(e,n){c.plan(r,{quantity:1}).currency(o).done((function(n){var t=parseFloat(n.next.total),r=t*a;isNaN(r)&&(r=0);var o=t+r;o%1!=0&&(o=o.toFixed(2)),e("".concat(i).concat(o))}))}))}}}}]),e.controller("ChangePlanFormController",["$scope","$modal","RecurlyPricing",function(e,t,r){n()&&(e.changePlan=function(){return t.open({templateUrl:"confirmChangePlanModalTemplate",controller:"ConfirmChangePlanController",scope:e})},e.$watch("plan",(function(n){if(n){var t=n.planCode,o=window.subscription.recurly,a=o.currency,i=o.taxRate;e.price="...",r.loadDisplayPriceWithTax(t,a,i).then((function(n){e.price=n}))}})))}]),e.controller("ConfirmChangePlanController",["$scope","$modalInstance","$http",function(e,n,t){return e.confirmChangePlan=function(){var n={plan_code:e.plan.planCode,_csrf:window.csrfToken};return e.inflight=!0,t.post("".concat("/user/subscription/update","?origin=confirmChangePlan"),n).then((function(){return location.reload()})).catch((function(){return console.log("something went wrong changing plan")}))},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("LeaveGroupModalController",["$scope","$modalInstance","$http",function(e,n,t){return e.confirmLeaveGroup=function(){return e.inflight=!0,t({url:"/subscription/group/user",method:"DELETE",params:{admin_user_id:e.admin_id,_csrf:window.csrfToken}}).then((function(){return location.reload()})).catch((function(){return console.log("something went wrong changing plan")}))},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("GroupMembershipController",["$scope","$modal",function(e,n){e.removeSelfFromGroup=function(t){return e.admin_id=t,n.open({templateUrl:"LeaveGroupModalTemplate",controller:"LeaveGroupModalController",scope:e})}}]),e.controller("RecurlySubscriptionController",["$scope",function(e){var t=n();e.showChangePlanButton=t&&!subscription.groupPlan,e.recurlyLoadError=!t,e.switchToDefaultView=function(){e.showCancellation=!1,e.showChangePlan=!1},e.switchToDefaultView(),e.switchToCancellationView=function(){e.showCancellation=!0,e.showChangePlan=!1},e.switchToChangePlanView=function(){e.showCancellation=!1,e.showChangePlan=!0}}]),e.controller("RecurlyCancellationController",["$scope","RecurlyPricing","$http",function(e,t,r){if(n()){var o=window.subscription,a=new Date;a.setDate(a.getDate()+7);var i=new Date(o.recurly.trial_ends_at),c=i>new Date,l=i<a,s=-1!==o.plan.planCode.indexOf("collaborator")&&-1===o.plan.planCode.indexOf("ann")&&!o.groupPlan,u=c&&l;s&&u?e.showExtendFreeTrial=!0:s&&!u?e.showDowngradeToStudent=!0:e.showBasicCancel=!0;var d=window.subscription.recurly,f=d.currency,p=d.taxRate;e.studentPrice="...",t.loadDisplayPriceWithTax("student",f,p).then((function(n){e.studentPrice=n})),e.downgradeToStudent=function(){var n={plan_code:"student",_csrf:window.csrfToken};return e.inflight=!0,r.post("".concat("/user/subscription/update","?origin=downgradeToStudent"),n).then((function(){return location.reload()})).catch((function(){return console.log("something went wrong changing plan")}))},e.cancelSubscription=function(){var n={_csrf:window.csrfToken};return e.inflight=!0,r.post("/user/subscription/cancel",n).then((function(){return location.href="/user/subscription/canceled"})).catch((function(){return console.log("something went wrong changing plan")}))},e.extendTrial=function(){var n={_csrf:window.csrfToken};return e.inflight=!0,r.put("/user/subscription/extend",n).then((function(){return location.reload()})).catch((function(){return console.log("something went wrong changing plan")}))}}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(114)],void 0===(o=function(e){return e.controller("NewSubscriptionController",["$scope","MultiCurrencyPricing","$http","eventTracking","ccUtils",function(e,n,t,r,o){if("undefined"!=typeof recurly&&recurly){e.recurlyLoadError=!1,e.currencyCode=n.currencyCode,e.allCurrencies=n.plans,e.availableCurrencies={},e.planCode=window.plan_code,e.switchToStudent=function(){var n=window.plan_code.replace("collaborator","student");r.sendMB("subscription-form-switch-to-student",{plan:window.plan_code}),r.send("subscription-funnel","subscription-form-switch-to-student",window.plan_code),window.location="/user/subscription/new?planCode=".concat(n,"&currency=").concat(e.currencyCode,"&cc=").concat(e.data.coupon,"&itm_campaign=").concat(window.ITMCampaign,"&itm_content=").concat(window.ITMContent)},r.sendMB("subscription-form",{plan:window.plan_code}),r.send("subscription-funnel","subscription-form-viewed",window.plan_code),e.paymentMethod={value:"credit_card"},e.data={first_name:"",last_name:"",postal_code:"",address1:"",address2:"",state:"",city:"",country:window.countryCode,coupon:window.couponCode},e.validation={},e.processing=!1,e.threeDSecureFlow=!1,e.threeDSecureContainer=document.querySelector(".three-d-secure-container"),e.threeDSecureRecurlyContainer=document.querySelector(".three-d-secure-recurly-container"),recurly.configure({publicKey:window.recurlyApiKey,style:{all:{fontFamily:'"Open Sans", sans-serif',fontSize:"16px",fontColor:"#7a7a7a"},month:{placeholder:"MM"},year:{placeholder:"YY"},cvv:{placeholder:"CVV"}}});var a,i=recurly.Pricing();window.pricing=i,i.plan(window.plan_code,{quantity:1}).address({country:e.data.country}).tax({tax_code:"digital",vat_number:""}).currency(e.currencyCode).coupon(e.data.coupon).done(),i.on("change",(function(){for(var t in e.planName=i.items.plan.name,e.price=i.price,i.items.plan.trial&&(e.trialLength=i.items.plan.trial.length),e.monthlyBilling=1===i.items.plan.period.length,e.availableCurrencies={},i.items.plan.price)n.plans[t]&&(e.availableCurrencies[t]=n.plans[t]);if(i.items&&i.items.coupon&&i.items.coupon.discount&&"percent"===i.items.coupon.discount.type){var r=parseInt(i.price.base.plan.unit);e.normalPrice=r,i.items.coupon.applies_for_months>0&&i.items.coupon.discount.rate&&i.items.coupon.applies_for_months&&(e.discountMonths=i.items.coupon.applies_for_months,e.discountRate=100*i.items.coupon.discount.rate),i.price.taxes[0]&&i.price.taxes[0].rate&&(e.normalPrice+=r*i.price.taxes[0].rate)}e.$apply()})),e.applyCoupon=function(){return i.coupon(e.data.coupon).done()},e.applyVatNumber=function(){return i.tax({tax_code:"digital",vat_number:e.data.vat_number}).done()},e.changeCurrency=function(n){return e.currencyCode=n,i.currency(n).done()},e.inputHasError=function(e){return null!=e&&(e.$touched&&e.$invalid)},e.isFormValid=function(n){return"paypal"===e.paymentMethod.value?""!==e.data.country:n.$valid},e.updateCountry=function(){return i.address({country:e.data.country}).done()},e.setPaymentMethod=function(n){e.paymentMethod.value=n,e.validation.errorFields={},e.genericError=""};var c=function(n,o,c){if(o&&(a=o),e.validation.errorFields={},null==n){var s={_csrf:window.csrfToken,recurly_token_id:a.id,recurly_three_d_secure_action_result_token_id:c&&c.id,subscriptionDetails:{currencyCode:i.items.currency,plan_code:i.items.plan.code,coupon_code:i.items.coupon?i.items.coupon.code:"",first_name:e.data.first_name,last_name:e.data.last_name,isPaypal:"paypal"===e.paymentMethod.value,address:{address1:e.data.address1,address2:e.data.address2,country:e.data.country,state:e.data.state,postal_code:e.data.postal_code},ITMCampaign:window.ITMCampaign,ITMContent:window.ITMContent}};return r.sendMB("subscription-form-submitted",{currencyCode:s.subscriptionDetails.currencyCode,plan_code:s.subscriptionDetails.plan_code,coupon_code:s.subscriptionDetails.coupon_code,isPaypal:s.subscriptionDetails.isPaypal}),r.send("subscription-funnel","subscription-form-submitted",s.subscriptionDetails.plan_code),t.post("/user/subscription/create",s).then((function(){r.sendMB("subscription-submission-success"),r.send("subscription-funnel","subscription-submission-success",s.subscriptionDetails.plan_code),window.location.href="/user/subscription/thank-you"})).catch((function(n){e.processing=!1;var t=n.data;e.genericError=t&&t.message||"Something went wrong processing the request",t.threeDSecureActionTokenId&&l(t.threeDSecureActionTokenId)}))}r.sendMB("subscription-error",n),r.send("subscription-funnel","subscription-error"),e.$evalAsync((function(){e.processing=!1,e.genericError=n.message,_.each(n.fields,(function(n){return e.validation.errorFields[n]=!0}))}))};e.submit=function(){if(e.processing=!0,"paypal"===e.paymentMethod.value){var n={description:e.planName};return recurly.paypal(n,c)}return recurly.token(e.data,c)};var l=function(n){var t=recurly.Risk().ThreeDSecure({actionTokenId:n});t.on("error",(function(n){e.genericError="Error: ".concat(n.message),e.threeDSecureFlow=!1,e.$apply()})),t.on("token",(function(n){c(null,null,n),e.genericError=null,e.threeDSecureFlow=!1,e.processing=!0,e.$apply()})),e.threeDSecureRecurlyContainer.innerHTML="",e.threeDSecureFlow=!0,t.attach(e.threeDSecureRecurlyContainer),window.setTimeout((function(){e.threeDSecureContainer.scrollIntoView()}),0)};e.countries=[{code:"AF",name:"Afghanistan"},{code:"AX",name:"Åland Islands"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AC",name:"Ascension Island"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"BQ",name:"British Antarctic Territory"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"CV",name:"Cabo Verde"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"IC",name:"Canary Islands"},{code:"CT",name:"Canton and Enderbury Islands"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"EA",name:"Ceuta and Melilla"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CP",name:"Clipperton Island"},{code:"CC",name:"Cocos [Keeling] Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo - Brazzaville"},{code:"CD",name:"Congo - Kinshasa"},{code:"CD",name:"Congo [DRC]"},{code:"CG",name:"Congo [Republic]"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"CI",name:"Côte d’Ivoire"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"DK",name:"Denmark"},{code:"DG",name:"Diego Garcia"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"NQ",name:"Dronning Maud Land"},{code:"TL",name:"East Timor"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands [Islas Malvinas]"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"FQ",name:"French Southern and Antarctic Territories"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GW",name:"Guinea-Bissau"},{code:"GN",name:"Guinea"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard Island and McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"CI",name:"Ivory Coast"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JT",name:"Johnston Island"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macau SAR China"},{code:"MO",name:"Macau"},{code:"MK",name:"Macedonia [FYROM]"},{code:"MK",name:"Macedonia"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"FX",name:"Metropolitan France"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MI",name:"Midway Islands"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar [Burma]"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"AN",name:"Netherlands Antilles"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"VD",name:"North Vietnam"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"QO",name:"Outlying Oceania"},{code:"PC",name:"Pacific Islands Trust Territory"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PZ",name:"Panama Canal Zone"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"YD",name:"People's Democratic Republic of Yemen"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RE",name:"Réunion"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"BL",name:"Saint Barthélemy"},{code:"SH",name:"Saint Helena"},{code:"KN",name:"Saint Kitts and Nevis"},{code:"LC",name:"Saint Lucia"},{code:"MF",name:"Saint Martin"},{code:"PM",name:"Saint Pierre and Miquelon"},{code:"VC",name:"Saint Vincent and the Grenadines"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"São Tomé and Príncipe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"CS",name:"Serbia and Montenegro"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard and Jan Mayen"},{code:"SZ",name:"Swaziland"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad and Tobago"},{code:"TA",name:"Tristan da Cunha"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks and Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"UM",name:"U.S. Minor Outlying Islands"},{code:"PU",name:"U.S. Miscellaneous Pacific Islands"},{code:"VI",name:"U.S. Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WK",name:"Wake Island"},{code:"WF",name:"Wallis and Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"}]}else e.recurlyLoadError=!0}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("AnnualUpgradeController",["$scope","$http","$modal",function(e,n,t){e.upgradeComplete=!1;var r={student:"19.2",collaborator:"36"};return e.$watch(e.planName,(function(){if(e.yearlySaving=r[e.planName],"annual"===e.planName)return e.upgradeComplete=!0})),e.completeAnnualUpgrade=function(){var t={planName:e.planName,_csrf:window.csrfToken};return e.inflight=!0,n.post("/user/subscription/upgrade-annual",t).then((function(){return e.upgradeComplete=!0})).catch((function(){return console.log("something went wrong changing plan")}))}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("RegisterUsersController",["$scope","queuedHttp",function(e,n){e.users=[],e.inputs={emails:""};return e.registerUsers=function(){var t=function(e){var n=e.split(/[\s,]+/);return n=_.map(n,(function(e){return e.trim()})),n=_.filter(n,(function(e){return-1!==e.indexOf("@")}))}(e.inputs.emails);return e.error=!1,Array.from(t).map((function(t){return n.post("/admin/register",{email:t,_csrf:window.csrfToken}).then((function(n){var t=n.data;return e.users.push(t),e.inputs.emails=""})).catch((function(){return e.error=!0}))}))}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("TeamInviteController",["$scope","$http",function(e,n){return e.inflight=!1,hasIndividualRecurlySubscription?e.view="hasIndividualRecurlySubscription":e.view="teamInvite",e.keepPersonalSubscription=function(){return e.view="teamInvite"},e.cancelPersonalSubscription=function(){e.inflight=!0;var t=n.post("/user/subscription/cancel",{_csrf:window.csrfToken});return t.then((function(){return e.inflight=!1,e.view="teamInvite"})),t.catch((function(){e.inflight=!1,e.cancel_error=!0,console.log("the request failed")}))},e.joinTeam=function(){e.inflight=!0;var t=n.put("/subscription/invites/".concat(window.inviteToken,"/"),{_csrf:window.csrfToken});return t.then((function(n){var t=n.status;if(e.inflight=!1,e.view="inviteAccepted",200!==t)return e.requestSent=!1})),t.catch((function(){return console.log("the request failed")}))}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("UpgradeSubscriptionController",["$scope","eventTracking",function(e,n){e.upgradeSubscription=function(){n.send("subscription-funnel","subscription-page","upgrade")}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("GroupPlanContactController",["$scope","$modal","$http",function(e,n,t){return e.form={},e.sent=!1,e.sending=!1,e.error=!1,e.contactUs=function(){if(null!=e.form.email){e.sending=!0;Math.floor(65536*(1+Math.random())).toString(32);var n={_csrf:window.csrfToken,name:e.form.name||e.form.email,email:e.form.email,labels:"".concat(e.form.source," accounts"),message:"Please contact me with more details",subject:"".concat(e.form.name," - Group Enquiry - ").concat(e.form.position," - ").concat(e.form.university),inbox:"accounts"},r=t.post("/support",n);return r.catch((function(){return e.error=!0,e.$apply()})),r.then((function(n){return e.sent=!0,eventTracking.send("subscription-funnel","plans-page","group-inquiry-sent"),e.error=200!==n.status,e.$apply()}))}console.log("email not set")}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(39),t(40)],void 0===(o=function(e){return e.controller("SearchWikiController",["$scope","algoliaSearch","_","$modal",function(e,n,t,r){e.hits=[],e.hits_total=0,e.config_hits_per_page=20,e.processingSearch=!1,e.clearSearchText=function(){return e.searchQueryText="",a([])},e.safeApply=function(n){var t=e.$root.$$phase;return"$apply"===t||"$digest"===t?e.$eval(n):e.$apply(n)};var o=function(e){var n=e.kb?"how-to/":"latex/",t=encodeURIComponent(e.pageName.replace(/\s/g,"_")),r="";e.sectionName&&""!==e.sectionName&&(r="#"+e.sectionName.replace(/\s/g,"_"));var o=e._highlightResult.sectionName,a=e._highlightResult.pageName.value;o&&o.value&&""!==o&&(a+=" - "+o.value);for(var i=e._highlightResult.content.value,c=(i=i.replace(/\n\n+/g,"\n\n")).split("\n"),l=[],s=0,u=Array.from(c);s<u.length;s++){var d=u[s];/^\[edit\]/.test(d)||(i+=d+"\n",/<em>/.test(d)&&l.push(d))}return i=l.join("\n...\n"),{name:a,url:"/learn/".concat(n).concat(t).concat(r),content:i}},a=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.safeApply((function(){e.hits=n,e.hits_total=t}))};e.search=function(){e.processingSearch=!0;var r=e.searchQueryText;if(null!=r&&0!==r.length)return n.searchWiki(r,{hitsPerPage:e.config_hits_per_page},(function(n,r){if(e.processingSearch=!1,0===r.hits.length)return a([]);var i=t.map(r.hits,o);return a(i,r.nbHits)}));a([])}}]),e.controller("LearnController",(function(){}))}.apply(n,r))||(e.exports=o)},,,,,,,,,,,,,,,,,,,,function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){var n=function(e,n,t,r){var o=this;o.roles=[],o.departments=[],o.countries=[],o.universities=[];var a=[];o.addUniversityToSelection=function(e){return{name:e,isUserSuggested:!0}},o.handleFreeformInputChange=function(e,n){if(null!=e.search&&""!==e.search){var t=e.search;if(null!=(null!=e.tagging?e.tagging.fct:void 0)&&(t=e.tagging.fct(e.search)),null!=n){var r=_.find(e.items,(function(t){return t[n]===e.search}));null!=r&&(t=r)}return e.searchInput.scope().$broadcast("uis:select",t)}},r.getCountries().then((function(e){return o.countries=e})),r.getDefaultRoleHints().then((function(e){return o.roles=e})),r.getDefaultDepartmentHints().then((function(e){return a=e})),e.$watch("$ctrl.affiliationData.country",(function(e,n){if(null!=e&&e!==n)return o.affiliationData.university=null,o.affiliationData.role=null,o.affiliationData.department=null,r.getUniversitiesFromCountry(e).then((function(e){return o.universities=e}))})),e.$watch("$ctrl.affiliationData.university",(function(e,n){return null!=e&&e!==n&&(null!=e.departments?e.departments.length:void 0)>0?o.departments=_.uniq(e.departments):o.departments=a}))};return n.$inject=["$scope","$element","$attrs","UserAffiliationsDataService"],e.component("affiliationForm",{bindings:{affiliationData:"=",showUniversityAndCountry:"<",showRoleAndDepartment:"<"},controller:n,templateUrl:"affiliationFormTpl"})}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("UserAffiliationsController",["$scope","UserAffiliationsDataService","$q","$window","_",function(e,n,t,r,o){e.userEmails=[],e.linkedInstitutionIds=[],e.hideInstitutionNotifications={},e.closeInstitutionNotification=function(n){e.hideInstitutionNotifications[n]=!0},e.samlBetaSession=ExposedSettings.hasSamlBeta,e.samlInitPath=ExposedSettings.samlInitPath;var a=/([^@]+)@(.+)/,i=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\ ".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA -Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,c=function(e){var n=e?e.match(a):void 0;return n?{local:n[1],domain:n[2]}:{local:null,domain:null}},l=function(n){if(!ExposedSettings.hasSamlFeature)return!1;if(!n)return!1;var t=n.university||n.institution;return!!t&&(!(!t||!t.ssoEnabled)||!!(e.samlBetaSession&&t&&t.ssoBeta))};e.getEmailSuggestion=function(r){var o=c(r);return e.ui.isValidEmail=i.test(r),e.ui.isBlacklistedEmail=!1,e.ui.showManualUniversitySelectionUI=!1,o.domain?(e.ui.isBlacklistedEmail=n.isDomainBlacklisted(o.domain),n.getUniversityDomainFromPartialDomainInput(o.domain).then((function(n){return c(e.newAffiliation.email).domain===n.hostname?(e.newAffiliation.university=n.university,e.newAffiliation.department=n.department,e.newAffiliation.ssoAvailable=l(n)):f(),t.resolve("".concat(o.local,"@").concat(n.hostname))})).catch((function(){return f(),t.reject(null)}))):(f(),t.reject(null))},e.linkInstitutionAcct=function(n,t){p(),e.ui.isMakingRequest=!0,e.ui.isProcessing=!0,r.location.href="".concat(e.samlInitPath,"?university_id=").concat(t,"&auto=/user/settings&email=").concat(n)},e.selectUniversityManually=function(){f(),e.ui.showManualUniversitySelectionUI=!0},e.changeAffiliation=function(t){o.get(t,["affiliation","institution","id"])&&n.getUniversityDetails(t.affiliation.institution.id).then((function(n){return e.affiliationToChange.university=n})),e.affiliationToChange.email=t.email,e.affiliationToChange.role=t.affiliation.role,e.affiliationToChange.department=t.affiliation.department},e.saveAffiliationChange=function(t){return t.affiliation.role=e.affiliationToChange.role,t.affiliation.department=e.affiliationToChange.department,s(),h(n.addRoleAndDepartment(t.email,t.affiliation.role,t.affiliation.department)).then((function(){return setTimeout((function(){return g()}))}))},e.cancelAffiliationChange=function(e){return s()},e.isChangingAffiliation=function(n){return e.affiliationToChange.email===n},e.showAddEmailForm=function(){return e.ui.showAddEmailUI=!0},e.addNewEmail=function(){var t;return t=e.newAffiliation.university?e.newAffiliation.university.isUserSuggested?n.addUserAffiliationWithUnknownUniversity(e.newAffiliation.email,e.newAffiliation.university.name,e.newAffiliation.country.code,e.newAffiliation.role,e.newAffiliation.department):n.addUserAffiliation(e.newAffiliation.email,e.newAffiliation.university.id,e.newAffiliation.role,e.newAffiliation.department):n.addUserEmail(e.newAffiliation.email),e.ui.isAddingNewEmail=!0,e.ui.showAddEmailUI=!1,h(t).then((function(){u(),d(),setTimeout((function(){return g()}))})).finally((function(){return e.ui.isAddingNewEmail=!1}))},e.setDefaultUserEmail=function(t){return h(n.setDefaultUserEmail(t.email)).then((function(){var n=!0,r=!1,o=void 0;try{for(var a,i=(e.userEmails||[])[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){a.value.default=!1}}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}t.default=!0}))},e.removeUserEmail=function(t){return e.userEmails=e.userEmails.filter((function(e){return e!==t})),h(n.removeUserEmail(t.email))},e.resendConfirmationEmail=function(t){return p(),e.ui.isResendingConfirmation=!0,h(n.resendConfirmationEmail(t.email)).finally((function(){return e.ui.isResendingConfirmation=!1}))},e.acknowledgeError=function(){return m(),g()};var s=function(){return e.affiliationToChange={email:"",university:null,role:null,department:null}},u=function(){return e.newAffiliation={email:"",country:null,university:null,role:null,department:null}},d=function(){e.ui.showAddEmailUI=!1,e.ui.isValidEmail=!1,e.ui.isBlacklistedEmail=!1,e.ui.showManualUniversitySelectionUI=!1},f=function(){e.newAffiliation={email:e.newAffiliation.email}},p=function(){e.ui.isLoadingEmails=!1,e.ui.isProcessing=!1,e.ui.isResendingConfirmation=!1},m=function(){return e.ui={hasError:!1,errorMessage:"",showChangeAffiliationUI:!1,isMakingRequest:!1,isLoadingEmails:!1,isAddingNewEmail:!1},s(),u(),d()};m();var h=function(n){return e.ui.hasError=!1,e.ui.isMakingRequest=!0,n.catch((function(n){e.ui.hasError=!0,e.ui.errorMessage=o.get(n,["data","message"])})).finally((function(){return e.ui.isMakingRequest=!1})),n};e.institutionAlreadyLinked=function(n){var t=n.affiliation&&n.affiliation.institution&&n.affiliation.institution&&n.affiliation.institution.id?n.affiliation.institution.id.toString():void 0;return-1!==e.linkedInstitutionIds.indexOf(t)};var g=function(){p(),e.ui.isLoadingEmails=!0,h(n.getUserEmails()).then((function(n){e.userEmails=n.map((function(e){return e.ssoAvailable=l(e.affiliation),e})),e.linkedInstitutionIds=n.filter((function(e){if(e.samlProviderId)return e.samlProviderId})).map((function(e){return e.samlProviderId}))})).finally((function(){return e.ui.isLoadingEmails=!1}))};g()}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){for(var n=[{code:"af",name:"Afghanistan"},{code:"ax",name:"Åland Islands"},{code:"al",name:"Albania"},{code:"dz",name:"Algeria"},{code:"as",name:"American Samoa"},{code:"ad",name:"Andorra"},{code:"ao",name:"Angola"},{code:"ai",name:"Anguilla"},{code:"aq",name:"Antarctica"},{code:"ag",name:"Antigua and Barbuda"},{code:"ar",name:"Argentina"},{code:"am",name:"Armenia"},{code:"aw",name:"Aruba"},{code:"au",name:"Australia"},{code:"at",name:"Austria"},{code:"az",name:"Azerbaijan"},{code:"bs",name:"Bahamas"},{code:"bh",name:"Bahrain"},{code:"bd",name:"Bangladesh"},{code:"bb",name:"Barbados"},{code:"by",name:"Belarus"},{code:"be",name:"Belgium"},{code:"bz",name:"Belize"},{code:"bj",name:"Benin"},{code:"bm",name:"Bermuda"},{code:"bt",name:"Bhutan"},{code:"bo",name:"Bolivia"},{code:"bq",name:"Bonaire, Saint Eustatius and Saba"},{code:"ba",name:"Bosnia and Herzegovina"},{code:"bw",name:"Botswana"},{code:"bv",name:"Bouvet Island"},{code:"br",name:"Brazil"},{code:"io",name:"British Indian Ocean Territory"},{code:"vg",name:"British Virgin Islands"},{code:"bn",name:"Brunei"},{code:"bg",name:"Bulgaria"},{code:"bf",name:"Burkina Faso"},{code:"bi",name:"Burundi"},{code:"kh",name:"Cambodia"},{code:"cm",name:"Cameroon"},{code:"ca",name:"Canada"},{code:"cv",name:"Cabo Verde"},{code:"ky",name:"Cayman Islands"},{code:"cf",name:"Central African Republic"},{code:"td",name:"Chad"},{code:"cl",name:"Chile"},{code:"cn",name:"China"},{code:"cx",name:"Christmas Island"},{code:"cc",name:"Cocos (Keeling) Islands"},{code:"co",name:"Colombia"},{code:"km",name:"Comoros"},{code:"cg",name:"Congo"},{code:"ck",name:"Cook Islands"},{code:"cr",name:"Costa Rica"},{code:"ci",name:"Côte d'Ivoire"},{code:"hr",name:"Croatia"},{code:"cu",name:"Cuba"},{code:"cw",name:"Curaçao"},{code:"cy",name:"Cyprus"},{code:"cz",name:"Czech Republic"},{code:"kp",name:"Democratic People's Republic of Korea"},{code:"cd",name:"Democratic Republic of the Congo"},{code:"dk",name:"Denmark"},{code:"dj",name:"Djibouti"},{code:"dm",name:"Dominica"},{code:"do",name:"Dominican Republic"},{code:"ec",name:"Ecuador"},{code:"eg",name:"Egypt"},{code:"sv",name:"El Salvador"},{code:"gq",name:"Equatorial Guinea"},{code:"er",name:"Eritrea"},{code:"ee",name:"Estonia"},{code:"et",name:"Ethiopia"},{code:"fk",name:"Falkland Islands (Malvinas)"},{code:"fo",name:"Faroe Islands"},{code:"fj",name:"Fiji"},{code:"fi",name:"Finland"},{code:"fr",name:"France"},{code:"gf",name:"French Guiana"},{code:"pf",name:"French Polynesia"},{code:"tf",name:"French Southern Territories"},{code:"ga",name:"Gabon"},{code:"gm",name:"Gambia"},{code:"ge",name:"Georgia"},{code:"de",name:"Germany"},{code:"gh",name:"Ghana"},{code:"gi",name:"Gibraltar"},{code:"gr",name:"Greece"},{code:"gl",name:"Greenland"},{code:"gd",name:"Grenada"},{code:"gp",name:"Guadeloupe"},{code:"gu",name:"Guam"},{code:"gt",name:"Guatemala"},{code:"gg",name:"Guernsey"},{code:"gn",name:"Guinea"},{code:"gw",name:"Guinea-Bissau"},{code:"gy",name:"Guyana"},{code:"ht",name:"Haiti"},{code:"hm",name:"Heard Island and McDonald Islands"},{code:"va",name:"Holy See (Vatican City)"},{code:"hn",name:"Honduras"},{code:"hk",name:"Hong Kong"},{code:"hu",name:"Hungary"},{code:"is",name:"Iceland"},{code:"in",name:"India"},{code:"id",name:"Indonesia"},{code:"ir",name:"Iran"},{code:"iq",name:"Iraq"},{code:"ie",name:"Ireland"},{code:"im",name:"Isle of Man"},{code:"il",name:"Israel"},{code:"it",name:"Italy"},{code:"jm",name:"Jamaica"},{code:"jp",name:"Japan"},{code:"je",name:"Jersey"},{code:"jo",name:"Jordan"},{code:"kz",name:"Kazakhstan"},{code:"ke",name:"Kenya"},{code:"ki",name:"Kiribati"},{code:"xk",name:"Kosovo"},{code:"kw",name:"Kuwait"},{code:"kg",name:"Kyrgyzstan"},{code:"la",name:"Laos"},{code:"lv",name:"Latvia"},{code:"lb",name:"Lebanon"},{code:"ls",name:"Lesotho"},{code:"lr",name:"Liberia"},{code:"ly",name:"Libya"},{code:"li",name:"Liechtenstein"},{code:"lt",name:"Lithuania"},{code:"lu",name:"Luxembourg"},{code:"mo",name:"Macao"},{code:"mk",name:"Macedonia"},{code:"mg",name:"Madagascar"},{code:"mw",name:"Malawi"},{code:"my",name:"Malaysia"},{code:"mv",name:"Maldives"},{code:"ml",name:"Mali"},{code:"mt",name:"Malta"},{code:"mh",name:"Marshall Islands"},{code:"mq",name:"Martinique"},{code:"mr",name:"Mauritania"},{code:"mu",name:"Mauritius"},{code:"yt",name:"Mayotte"},{code:"mx",name:"Mexico"},{code:"fm",name:"Micronesia"},{code:"md",name:"Moldova"},{code:"mc",name:"Monaco"},{code:"mn",name:"Mongolia"},{code:"me",name:"Montenegro"},{code:"ms",name:"Montserrat"},{code:"ma",name:"Morocco"},{code:"mz",name:"Mozambique"},{code:"mm",name:"Myanmar"},{code:"na",name:"Namibia"},{code:"nr",name:"Nauru"},{code:"np",name:"Nepal"},{code:"nl",name:"Netherlands"},{code:"an",name:"Netherlands Antilles"},{code:"nc",name:"New Caledonia"},{code:"nz",name:"New Zealand"},{code:"ni",name:"Nicaragua"},{code:"ne",name:"Niger"},{code:"ng",name:"Nigeria"},{code:"nu",name:"Niue"},{code:"nf",name:"Norfolk Island"},{code:"mp",name:"Northern Mariana Islands"},{code:"no",name:"Norway"},{code:"om",name:"Oman"},{code:"pk",name:"Pakistan"},{code:"pw",name:"Palau"},{code:"ps",name:"Palestine"},{code:"pa",name:"Panama"},{code:"pg",name:"Papua New Guinea"},{code:"py",name:"Paraguay"},{code:"pe",name:"Peru"},{code:"ph",name:"Philippines"},{code:"pn",name:"Pitcairn"},{code:"pl",name:"Poland"},{code:"pt",name:"Portugal"},{code:"pr",name:"Puerto Rico"},{code:"qa",name:"Qatar"},{code:"kr",name:"Republic of Korea"},{code:"re",name:"Réunion"},{code:"ro",name:"Romania"},{code:"ru",name:"Russia"},{code:"rw",name:"Rwanda"},{code:"bl",name:"Saint Barthélemy"},{code:"sh",name:"Saint Helena, Ascension and Tristan da Cunha"},{code:"kn",name:"Saint Kitts and Nevis"},{code:"lc",name:"Saint Lucia"},{code:"mf",name:"Saint Martin"},{code:"pm",name:"Saint Pierre and Miquelon"},{code:"vc",name:"Saint Vincent and the Grenadines"},{code:"ws",name:"Samoa"},{code:"sm",name:"San Marino"},{code:"st",name:"Sao Tome and Principe"},{code:"sa",name:"Saudi Arabia"},{code:"sn",name:"Senegal"},{code:"rs",name:"Serbia"},{code:"sc",name:"Seychelles"},{code:"sl",name:"Sierra Leone"},{code:"sg",name:"Singapore"},{code:"sx",name:"Sint Maarten"},{code:"sk",name:"Slovakia"},{code:"si",name:"Slovenia"},{code:"sb",name:"Solomon Islands"},{code:"so",name:"Somalia"},{code:"za",name:"South Africa"},{code:"gs",name:"South Georgia and the South Sandwich Islands"},{code:"ss",name:"South Sudan"},{code:"es",name:"Spain"},{code:"lk",name:"Sri Lanka"},{code:"sd",name:"Sudan"},{code:"sr",name:"Suriname"},{code:"sj",name:"Svalbard and Jan Mayen"},{code:"sz",name:"Swaziland"},{code:"se",name:"Sweden"},{code:"ch",name:"Switzerland"},{code:"sy",name:"Syria"},{code:"tw",name:"Taiwan"},{code:"tj",name:"Tajikistan"},{code:"tz",name:"Tanzania"},{code:"th",name:"Thailand"},{code:"tl",name:"Timor-Leste"},{code:"tg",name:"Togo"},{code:"tk",name:"Tokelau"},{code:"to",name:"Tonga"},{code:"tt",name:"Trinidad and Tobago"},{code:"tn",name:"Tunisia"},{code:"tr",name:"Turkey"},{code:"tm",name:"Turkmenistan"},{code:"tc",name:"Turks and Caicos Islands"},{code:"tv",name:"Tuvalu"},{code:"vi",name:"U.S. Virgin Islands"},{code:"ug",name:"Uganda"},{code:"ua",name:"Ukraine"},{code:"ae",name:"United Arab Emirates"},{code:"gb",name:"United Kingdom"},{code:"us",name:"United States of America"},{code:"um",name:"United States Minor Outlying Islands"},{code:"uy",name:"Uruguay"},{code:"uz",name:"Uzbekistan"},{code:"vu",name:"Vanuatu"},{code:"ve",name:"Venezuela"},{code:"vn",name:"Vietnam"},{code:"wf",name:"Wallis and Futuna"},{code:"eh",name:"Western Sahara"},{code:"ye",name:"Yemen"},{code:"zm",name:"Zambia"},{code:"zw",name:"Zimbabwe"}],t={},r={},o=["Undergraduate Student","Masters Student (MSc, MA, ...)","Doctoral Student (PhD, EngD, ...)","Postdoc","Lecturer","Senior Lecturer","Reader","Associate Professor ","Assistant Professor ","Professor","Emeritus Professor"],a=["Aeronautics & Astronautics","Anesthesia","Anthropology","Applied Physics","Art & Art History","Biochemistry","Bioengineering","Biology","Business School Library","Business, Graduate School of","Cardiothoracic Surgery","Chemical and Systems Biology","Chemical Engineering","Chemistry","Civil & Environmental Engineering","Classics","Communication","Comparative Literature","Comparative Medicine","Computer Science","Dermatology","Developmental Biology","Earth System Science","East Asian Languages and Cultures","Economics","Education, School of","Electrical Engineering","Energy Resources Engineering","English","French and Italian","Genetics","Geological Sciences","Geophysics","German Studies","Health Research & Policy","History","Iberian & Latin American Cultures","Law Library","Law School","Linguistics","Management Science & Engineering","Materials Science & Engineering","Mathematics","Mechanical Engineering","Medical Library","Medicine","Microbiology & Immunology","Molecular & Cellular Physiology","Music","Neurobiology","Neurology & Neurological Sciences","Neurosurgery","Obstetrics and Gynecology","Ophthalmology","Orthopaedic Surgery","Otolaryngology (Head and Neck Surgery)","Pathology","Pediatrics","Philosophy","Physics","Political Science","Psychiatry and Behavioral Sciences","Psychology","Radiation Oncology","Radiology","Religious Studies","Slavic Languages and Literature","Sociology","University Libraries","Statistics","Structural Biology","Surgery","Theater and Performance Studies","Urology"],i={"overleaf.com":!0},c=["br","cn","co","co.jp","co.uk","com","com.au","de","fr","in","info","io","net","no","ru","se","us","com.tw","com.br","pl","it","co.in","com.mx"],l=0,s=Array.from(["gmail","googlemail","icloud","me","yahoo","ymail","yahoomail","hotmail","live","msn","outlook","gmx","mail","aol","163","mac","qq","o2","libero","126"]);l<s.length;l++)for(var u=s[l],d=0,f=Array.from(c);d<f.length;d++){var p=f[d];i["".concat(u,".").concat(p)]=!0}return e.factory("UserAffiliationsDataService",["$http","$q","_",function(e,c,l){var s=function(){return e.get("/user/emails").then((function(e){return e.data}))},u=function(e){return e.toLowerCase()in i};return{getCountries:function(){return c.resolve(n)},getDefaultRoleHints:function(){return c.resolve(o)},getDefaultDepartmentHints:function(){return c.resolve(a)},getUserEmails:s,getUserDefaultEmail:function(){return s().then((function(e){return l.find(e,(function(e){return e.default}))}))},getUniversitiesFromCountry:function(n){var r;return r=null!=t[n.code]?t[n.code]:e.get("/institutions/list",{params:{country_code:n.code}}).then((function(e){return t[n.code]=e.data})),c.resolve(r)},getUniversityDomainFromPartialDomainInput:function(n){return null!=r[n]?c.resolve(r[n]):e.get("/institutions/domains",{params:{hostname:n,limit:1}}).then((function(e){var n=e.data[0];return null==n||u(n.hostname)?c.reject(null):(r[n.hostname]=n,c.resolve(n))}))},getUniversityDetails:function(n){return e.get("/institutions/list/".concat(n)).then((function(e){return e.data}))},addUserEmail:function(n){return e.post("/user/emails",{email:n,_csrf:window.csrfToken})},addUserAffiliationWithUnknownUniversity:function(n,t,r,o,a){return e.post("/user/emails",{email:n,university:{name:t,country_code:r},role:o,department:a,_csrf:window.csrfToken})},addUserAffiliation:function(n,t,r,o){return e.post("/user/emails",{email:n,university:{id:t},role:r,department:o,_csrf:window.csrfToken})},addRoleAndDepartment:function(n,t,r){return e.post("/user/emails/endorse",{email:n,role:t,department:r,_csrf:window.csrfToken})},setDefaultUserEmail:function(n){return e.post("/user/emails/default",{email:n,_csrf:window.csrfToken})},removeUserEmail:function(n){return e.post("/user/emails/delete",{email:n,_csrf:window.csrfToken})},resendConfirmationEmail:function(n){return e.post("/user/emails/resend_confirmation",{email:n,_csrf:window.csrfToken})},isDomainBlacklisted:u}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("UserOauthController",["$http","$scope","$q",function(e,n,t){var r=function(e,t){n.providers[e].ui.hasError=!0,n.providers[e].ui.errorMessage=t&&t.data&&t.data.message?t.data.message:"error"};n.unlink=function(t){if(window.ExposedSettings.isOverleaf){n.providers[t].ui={hasError:!1,isProcessing:!0};var o={_csrf:window.csrfToken,link:!1,providerId:t};e.post("/user/oauth-unlink",o).catch((function(e){n.providers[t].ui.isProcessing=!1,r(t,e)})).then((function(e){n.providers[t].ui.isProcessing=!1,200===e.status?n.thirdPartyIds[t]=null:r(t,e)}))}},n.ui={hasError:!1,errorMessage:""},n.providers=window.oauthProviders,n.thirdPartyIds=window.thirdPartyIds}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.constant("Keys",{ENTER:13,TAB:9,ESCAPE:27,SPACE:32,BACKSPACE:8,UP:38,DOWN:40,LEFT:37,RIGHT:39,PERIOD:190,COMMA:188,END:35})}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){e.controller("ImportingController",["$interval","$scope","$timeout","$window",function(e,n,t,r){e((function(){n.state.load_progress+=5,n.state.load_progress>100&&(n.state.load_progress=20)}),500),t((function(){r.location.reload()}),5e3),n.state={load_progress:20}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){e.directive("autoSubmitForm",(function(){return{link:function(e,n){n.submit()}}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(37)],void 0===(o=function(e){e.directive("asyncForm",["$http","validateCaptcha","validateCaptchaV3",function(e,n,t){return{controller:["$scope",function(e){return this.getEmail=function(){return e.email},this}],link:function(r,o,a){var i,c=a.asyncForm;r[a.name].response=i={},r[a.name].inflight=!1;var l=function(e){for(var n={},t=0,l=Array.from(o.serializeArray());t<l.length;t++){var s=l[t];n[s.name]=s.value}return null!=e&&(n["g-recaptcha-response"]=e),r[a.name].inflight=!0,u(o.attr("method"))(o.attr("action"),n,{disableAutoLoginRedirect:!0}).then((function(e){var n=e.data,t=e.headers;r[a.name].inflight=!1,i.success=!0,i.error=!1;var o=r[a.onSuccess];if(o)o(e);else{if(null!=n.redir)return ga("send","event",c,"success"),window.location=n.redir;if(null!=n.message)return i.message=n.message,"error"===n.message.type?(i.success=!1,i.error=!0,ga("send","event",c,"failure",n.message)):ga("send","event",c,"success");if(r.$eval(a.asyncFormDownloadResponse)){var l=new Blob([n],{type:t("Content-Type")});location.href=URL.createObjectURL(l)}}})).catch((function(e){var n;s=e.data,n=e.status,e.headers,e.config,r[a.name].inflight=!1,i.success=!1,i.error=!0,i.status=n,i.data=s;var t=r[a.onError];if(!t)return 400===n&&s.accountLinkingError?i.message={text:s.accountLinkingError,type:"error"}:i.message=400===n?{text:"Invalid Request. Please correct the data and try again.",type:"error"}:403===n?{text:"Session error. Please check you have cookies enabled. If the problem persists, try clearing your cache and cookies.",type:"error"}:429===n?{text:"Too many attempts. Please wait for a while and try again.",type:"error"}:{text:(null!=s.message?s.message.text:void 0)||s.message||"Something went wrong talking to the server :(. Please try again.",type:"error"},ga("send","event",c,"failure",s.message);t(e)}))},s=function(){return null==(e=function(e){return l(e)})&&(e=function(e){}),a.captchaActionName&&t(a.captchaActionName),null!=a.captcha?n(e):e();var e},u=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"post",t={post:e.post,get:e.get};return t[n.toLowerCase()]};if(o.on("submit",(function(e){return e.preventDefault(),s()})),a.autoSubmit)return s()}}}]),e.directive("formMessages",(function(){return{restrict:"E",template:"<div class=\"alert\" ng-class=\"{\n  'alert-danger': form.response.message.type == 'error',\n  'alert-success': form.response.message.type != 'error'\n}\" ng-show=\"!!form.response.message\" ng-bind-html=\"form.response.message.text\">\n</div>\n<div ng-transclude></div>",transclude:!0,scope:{form:"=for"}}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;function a(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r=[t(0),t(37)],void 0===(o=function(e){e.directive("complexPassword",(function(){return{require:["^asyncForm","ngModel"],link:function(e,n,t,r){PassField.Config.blackList=[];var o={pattern:"",length:{min:6,max:72},allowEmpty:!1,allowAnyChars:!1,isMasked:!0,showToggle:!1,showGenerate:!1,showTip:!1,showWarn:!1,checkMode:PassField.CheckModes.STRICT,chars:{digits:"1234567890",letters:"abcdefghijklmnopqrstuvwxyz",letters_up:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",symbols:"@#$%^&*()-_=+[]{};:<>/?!£€.,"}},i=_.defaults(window.passwordStrengthOptions||{},o);1===i.length.min&&(i.acceptRate=0),i.length.max>72&&(i.length.max=72),i.length.max>0&&(i.length.max+=1);var c=new PassField.Field("passwordField",i),l=a(Array.from(r),2),s=l[0],u=l[1];u.$parsers.unshift((function(n){var t=c.validatePass(),r=s.getEmail()||window.usersEmail;if(t){if("string"==typeof r&&""!==r){var o=r.split("@")[0];-1===n.indexOf(r)&&-1===n.indexOf(o)||(t=!1,e.complexPasswordErrorMessage="Password can not contain email address")}}else e.complexPasswordErrorMessage=c.getPassValidationMessage();return null!=i.length.max&&n.length>=i.length.max&&(t=!1,e.complexPasswordErrorMessage="Maximum password length ".concat(i.length.max-1," exceeded")),null!=i.length.min&&n.length<i.length.min&&(t=!1,e.complexPasswordErrorMessage="Password too short, minimum ".concat(i.length.min)),u.$setValidity("complexPassword",t),n}))}}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.directive("equals",(function(){return{require:"ngModel",link:function(e,n,t,r){var o="#".concat(t.equals);return n.add(o).on("keyup",(function(){return e.$apply((function(){var e=n.val()===$(o).val();return r.$setValidity("areEqual",e)}))}))}}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.directive("eventTracking",["eventTracking",function(e){return{scope:{eventTracking:"@",eventSegmentation:"=?"},link:function(n,t,r){var o=r.eventTrackingGa||!1,a=r.eventTrackingMb||!1,i=r.eventTrackingSendOnce?"sendMBOnce":"sendMB",c=r.eventTrackingSendOnce?"sendGAOnce":"send",l=n.eventSegmentation||{};l.page=window.location.pathname;var s=function(t){if(a&&e[i](n.eventTracking,l),o&&e[c](r.eventTrackingGa,r.eventTrackingAction||n.eventTracking,r.eventTrackingLabel||""),t)return $(window).unbind("resize scroll")};if("load"===r.eventTrackingTrigger)return s();if("click"===r.eventTrackingTrigger)return t.on("click",(function(e){return s()}));if("hover"===r.eventTrackingTrigger){var u=null,d=500;return r.eventHoverAmt&&(d=parseInt(r.eventHoverAmt,10)),t.on("mouseenter",(function(){u=setTimeout((function(){return s()}),d)})).on("mouseleave",(function(){return clearTimeout(u)}))}"scroll"!==r.eventTrackingTrigger||e.eventInCache(n.eventTracking)||$(window).on("resize scroll",_.throttle((function(){(function(e){var n=e.offset().top,t=n+e.outerHeight(),r=$(window).scrollTop(),o=r+$(window).height();return t>r&&n<o})(t)&&s(!0)}),500))}}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.directive("selectAllList",(function(){return{controller:["$scope",function(e){this.selectAll=function(){return e.$broadcast("select-all:select")},this.deselectAll=function(){return e.$broadcast("select-all:deselect")},this.clearSelectAllState=function(){return e.$broadcast("select-all:clear")}}],link:function(e,n,t){}}})),e.directive("selectAll",(function(){return{require:"^selectAllList",link:function(e,n,t,r){return e.$on("select-all:clear",(function(){return n.prop("checked",!1)})),n.change((function(){return n.is(":checked")?r.selectAll():r.deselectAll(),!0}))}}})),e.directive("selectIndividual",(function(){return{require:"^selectAllList",scope:{ngModel:"="},link:function(e,n,t,r){var o=!1;return e.$watch("ngModel",(function(e){if(null!=e&&!o)return r.clearSelectAllState()})),e.$on("select-all:select",(function(){if(!n.prop("disabled"))return o=!0,e.$apply((function(){return e.ngModel=!0})),o=!1})),e.$on("select-all:deselect",(function(){if(!n.prop("disabled"))return o=!0,e.$apply((function(){return e.ngModel=!1})),o=!1})),e.$on("select-all:row-clicked",(function(){if(!n.prop("disabled"))return o=!0,e.$apply((function(){if(e.ngModel=!e.ngModel,!e.ngModel)return r.clearSelectAllState()})),o=!1}))}}})),e.directive("selectRow",(function(){return{scope:!0,link:function(e,n,t){return n.on("click",(function(n){return e.$broadcast("select-all:row-clicked")}))}}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.directive("maxHeight",(function(){return{restrict:"A",link:function(e,n,t){return e.$watch(t.maxHeight,(function(e){if(null!=e)return n.css({"max-height":e})}))}}}))}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){e.directive("bookmarkableTabset",["$location","_",function(e,n){return{restrict:"A",require:"tabset",link:function(t,r,o,a){var i=function(e){if(e&&""!==e){var t=n.find(a.tabs,(function(n){return n.bookmarkableTabId===e}));if(t)return t.select(),r.children()[0].scrollIntoView({behavior:"smooth"})}};t.$applyAsync((function(){var n=e.hash();i(n);var t=document.querySelectorAll(".link-to-tab"),r=function(e){var n=e.currentTarget.getAttribute("href").split("#").pop();i(n)};t&&Array.from(t).map((function(e){return e.addEventListener("click",r)}))}))}}}]),e.directive("bookmarkableTab",["$location",function(e){return{restrict:"A",require:"tab",link:function(n,t,r,o){var a=t.isolateScope(),i=r.bookmarkableTab;a&&i&&""!==i&&(a.bookmarkableTabId=i,a.$watch("active",(function(n,t){if(n&&!t&&e.hash()!==i)return e.hash(i)})))}}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){var n=function(e,n,t,r){var o=this;o.showHint=!1,o.hasFocus=!1,o.handleFocus=function(){return o.hasFocus=!0,o.suggestion=null},o.handleBlur=function(){return o.showHint=!1,o.hasFocus=!1,o.suggestion=null,o.onBlur()},o.handleKeyDown=function(e){return e.which!==r.TAB&&e.which!==r.ENTER||null==o.suggestion||""===o.suggestion||(e.preventDefault(),o.localNgModel+=o.suggestion),o.suggestion=null,o.showHint=!1},e.$watch("$ctrl.localNgModel",(function(e,n){if(o.hasFocus&&e!==n)return o.suggestion=null,o.showHint=!1,o.getSuggestion({userInput:e}).then((function(n){if(null!=n&&e===o.localNgModel)return o.showHint=!0,o.suggestion=n.replace(e,"")})).catch((function(){return o.suggestion=null}))}))};return n.$inject=["$scope","$element","$attrs","Keys"],e.component("inputSuggestions",{bindings:{localNgModel:"=ngModel",localNgModelOptions:"=?ngModelOptions",getSuggestion:"&",onBlur:"&?",inputId:"@?",inputName:"@?",inputPlaceholder:"@?",inputType:"@?",inputRequired:"=?"},controller:n,template:['<div class="input-suggestions">','<div class="form-control input-suggestions-shadow">','<span ng-bind="$ctrl.localNgModel"',' class="input-suggestions-shadow-existing"',' ng-show="$ctrl.showHint">',"</span>",'<span ng-bind="$ctrl.suggestion"',' class="input-suggestions-shadow-suggested"',' ng-show="$ctrl.showHint">',"</span>","</div>",'<input type="text"',' class="form-control input-suggestions-main"',' ng-focus="$ctrl.handleFocus()"',' ng-keyDown="$ctrl.handleKeyDown($event)"',' ng-blur="$ctrl.handleBlur()"',' ng-model="$ctrl.localNgModel"',' ng-model-options="$ctrl.localNgModelOptions"',' ng-model-options="{ debounce: 50 }"',' ng-attr-id="{{ ::$ctrl.inputId }}"',' ng-attr-placeholder="{{ ::$ctrl.inputPlaceholder }}"',' ng-attr-type="{{ ::$ctrl.inputType }}"',' ng-attr-name="{{ ::$ctrl.inputName }}"',' ng-required="::$ctrl.inputRequired">',"</div>"].join("")})}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(243),t(249),t(250),t(251),t(255),t(257),t(258),t(259),t(260),t(261),t(262),t(264)],void 0===(o=function(){}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(244),t(245),t(246),t(247),t(123),t(123),t(248)],void 0===(o=function(){}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("AdminUserListController",["$scope","$http","$timeout","$window","$modal","queuedHttp",function(e,n,t,r,o,a){e.users=window.data.users,e.pages=window.data.pages,e.allSelected=!1,e.selectedUsers=[],e.timer,e.pageSelected=1,e.searchError=null;var i=function(){var n=$(".user-list-card").offset().top,t=$("footer").outerHeight()+25,o=$("aside").height()-56,a=r.innerHeight-n-t;return a<o&&(a=Math.min(o,r.innerHeight-n-25)),e.userListHeight=a};t((function(){return i()}),0),angular.element(r).bind("resize",(function(){return i(),e.$apply()}));var c=function(){e.isLoading=!0,e.searchError=null,data._csrf=window.csrfToken,data.query=e.searchText,data.regexp=e.searchRegExp,data.secondaryEmailSearch=e.secondaryEmailSearch,data.page=e.pageSelected;var t=n.post("/admin/user/search",data);return t.then((function(n){var t=n.data;return e.users=t.users,e.pages=t.pages,e.deletedUserCount=t.deletedUserCount,e.updateVisibleUsers(),e.isLoading=!1})),t.catch((function(n){n.data&&n.data.message?e.searchError=n.data:e.searchError={message:"Something went wrong"},e.isLoading=!1}))};return e.clearSearchText=function(){return e.searchText="",e.$emit("search:clear"),c()},e.searchUsers=function(){return e.pageSelected=1,c()},e.changePage=function(n){return e.pageSelected=n,c()},e.updateSelectedUsers=function(){return e.selectedUsers=e.users.filter((function(e){return e.selected}))},e.updateVisibleUsers=function(){e.visibleUsers=[];for(var n=0,t=Array.from(e.users);n<t.length;n++){var r=t[n];e.visibleUsers.push(r)}return e.updatePages()},e.getSelectedUsers=function(){return e.selectedUsers},e.getFirstSelectedUser=function(){return e.selectedUsers[0]},e.updatePages=function(){if(e.pagesList=[],e.pages>1)return function(e,n,t){for(var r=[],o=e<n,a=t?o?n+1:n-1:n,i=e;o?i<a:i>a;o?i++:i--)r.push(i);return r}(1,Math.min(100,e.pages),!0).map((function(n){return e.pagesList.push(n)}))},e._removeUserFromList=function(n){var t=e.users.indexOf(n);if(t>-1)return e.users.splice(t,1)},e.openDeleteUsersModal=function(){return o.open({templateUrl:"deleteUsersModalTemplate",controller:"DeleteUsersModalController",resolve:{users:function(){return e.getSelectedUsers()}}}).result.then((function(){return e.DeleteSelectedUsers()}))},e.DeleteSelectedUsers=function(){for(var n=e.getSelectedUsers(),t=0,r=Array.from(n);t<r.length;t++){var o=r[t];e._removeUserFromList(o),a({method:"DELETE",url:"/admin/user/".concat(o._id),headers:{"X-CSRF-Token":window.csrfToken}})}return e.searchUsers()},e.openSetPasswordModal=function(){return o.open({templateUrl:"setPasswordModalTemplate",controller:"SetPasswordModalController",resolve:{user:function(){return e.getFirstSelectedUser()}}}).result.then((function(n){return e.SetUserPassword(n)}))},e.SetUserPassword=function(n){var t=e.getFirstSelectedUser();return a.post("/admin/user/".concat(t._id,"/setPassword"),{newPassword:n,_csrf:window.csrfToken})},e.updateVisibleUsers()}]),e.controller("UserListItemController",["$scope",function(e){return e.$watch("user.selected",(function(n){if(null!=n)return e.updateSelectedUsers()}))}]),e.controller("DeleteUsersModalController",["$scope","$modalInstance","$timeout","users",function(e,n,t,r){return e.users=r,e.delete=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("SetPasswordModalController",["$scope","$modalInstance","$timeout","user",function(e,n,t,r){return e.user=r,e.inputs={newPassword:""},e.setPassword=function(){return n.close(e.inputs.newPassword)},e.cancel=function(){return n.dismiss("cancel")}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(11)],void 0===(o=function(e){e.controller("AdminUserController",["$scope","$timeout","$modal","queuedHttp",function(e,n,t,r){e.error=void 0,e.user=window.data.user,e.projects=window.data.projects,e.deletedProjects=window.data.deletedProjects,e.searchText={value:""},e.searchRegExp={value:!1},e.selectedProjects=[],e.predicate="lastUpdated",e.reverse=!0,e.allSelected=!1,e.enableBetaError=!1,e.emailForm={newEmail:null,isEditing:!1},e.user.primaryEmailData=e.user.emails.find((function(n){return n.email===e.user.email})),e.dismissError=function(){return e.error=void 0};for(var o=0,a=Array.from(e.projects);o<a.length;o++){var i=a[o];i.accessLevel="owner"}return e.clearSearchText=function(){return e.searchText.value="",e.updateVisibleProjects()},e.searchProjects=function(){return e.updateVisibleProjects()},e.updateSelectedProjects=function(){return e.selectedProjects=e.projects.filter((function(e){return e.selected}))},e.getSelectedProjects=function(){return e.selectedProjects},e.thirdPartyIdentifier=function(n){var t=e.user.thirdPartyIdentifiers;if(t)for(var r=0;r<t.length;r++)if(t[r].providerId===n)return t[r].externalUserId;return null},e.resetEmailFormOnCancel=function(){e.emailForm.isEditing=!1,e.emailForm.newEmail=null},e.emailFormOnSuccess=function(){location.reload()},e.archivedIsArray=function(e){return Array.isArray(e.archived)},e.openArchiveProjectsModal=function(){return t.open({templateUrl:"archiveTrashLeaveOrDeleteProjectsModalTemplate",controller:"ArchiveTrashLeaveOrDeleteProjectsModalController",resolve:{projects:function(){return e.getSelectedProjects()},action:function(){return"delete"}}}).result.then((function(){return e.archiveOrLeaveSelectedProjects()}))},e.archiveOrLeaveSelectedProjects=function(){for(var n=e.getSelectedProjects(),t=0,o=Array.from(n);t<o.length;t++)(i=o[t]).archived=!0,r({method:"DELETE",url:"/admin/project/".concat(i._id),headers:{"X-CSRF-Token":window.csrfToken}});return e.updateVisibleProjects()},e.changePredicate=function(n){return e.predicate===n&&(e.reverse=!e.reverse),e.predicate=n},e.getSortIconClass=function(n){return n===e.predicate&&e.reverse?"fa-caret-down":n!==e.predicate||e.reverse?"":"fa-caret-up"},e.openDeleteSecondaryEmailModal=function(n){return e.error=void 0,t.open({templateUrl:"deleteSecondaryEmailModalTemplate",controller:"DeleteSecondaryEmailModalController",resolve:{users:function(){return[{email:n}]}}}).result.then((function(){return r({method:"DELETE",url:"/admin/user/".concat(e.user._id,"/secondaryemail"),data:{emailToRemove:n},headers:{"Content-type":"application/json;charset=utf-8","X-CSRF-Token":window.csrfToken}}).then((function(){return setTimeout((function(){return window.location.href="/admin/user/".concat(e.user._id)}),100)})).catch((function(n){console.error(n),e.error=!0}))}))},e.openUnlinkOlModal=function(){return t.open({templateUrl:"unlinkOlModalTemplate",controller:"UnlinkOlModalController",resolve:{users:function(){return[e.user]}}}).result.then((function(){return r({method:"DELETE",url:"/admin/user/".concat(e.user._id,"/overleaf"),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return setTimeout((function(){return window.location.href="/admin/user/".concat(e.user._id)}),100)}))}))},e.openDeleteUserModal=function(){return t.open({templateUrl:"deleteUsersModalTemplate",controller:"DeleteUsersModalController",resolve:{users:function(){return[e.user]}}}).result.then((function(){return e.DeleteUser()}))},e.DeleteUser=function(){var n=e.user;return r({method:"DELETE",url:"/admin/user/".concat(n._id),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return setTimeout((function(){return window.location.href="/admin/user"}),100)}))},e.refreshFeatures=function(){var n=e.user;return e.refreshingFeatures=!0,r({method:"POST",url:"/admin/user/".concat(n._id,"/refresh_features"),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return location.reload()}))},e.openSetDefaultUserEmailModal=function(n){return t.open({templateUrl:"setDefaultUserEmailModalTemplate",controller:"SetDefaultUserEmailController",resolve:{email:function(){return n.email},confirmedAt:function(){return n.confirmedAt}}}).result.then((function(){return e.setDefaultUserEmail(n.email)}))},e.setDefaultUserEmail=function(n){var t=e.user;return r({method:"POST",url:"/admin/user/".concat(t._id,"/default_email"),headers:{"X-CSRF-Token":window.csrfToken},data:{email:n}}).then((function(){return location.reload()}))},e.generatePasswordResetUrl=function(){var n=e.user;return r({method:"POST",url:"/admin/user/".concat(n._id,"/generate_password_reset_url"),headers:{"X-CSRF-Token":window.csrfToken},data:{email:n.email}}).then((function(n){e.resetLink=!0,200===n.status?document.getElementById("resetLink").innerHTML+=n.data.url:document.getElementById("resetLink").innerHTML+="Error generating reset url"}))},e.updateVisibleProjects=function(){return e.visibleProjects=[],function(){for(var n=[],t=0,r=Array.from(e.projects);t<r.length;t++){i=r[t];var o=!0;null!=e.searchText.value&&""!==e.searchText.value&&(i.name.toLowerCase().match(e.searchText.value.toLowerCase())||(o=!1)),o?n.push(e.visibleProjects.push(i)):n.push(i.selected=!1)}return n}()},e.updateVisibleProjects()}]),e.controller("AdminDeletedProjectListItemController",["$scope","$http",function(e,n){e.getDeletedProjectName=function(e){return e.project?e.project.name:null}}]),e.controller("AdminProjectListItemController",["$scope",function(e){return e.$watch("project.selected",(function(n){if(null!=n)return e.updateSelectedProjects()}))}]),e.controller("UnlinkOlModalController",["$scope","$modalInstance","$timeout","users",function(e,n,t,r){e.users=r,e.unlink=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("DeleteSecondaryEmailModalController",["$scope","$modalInstance","$timeout","users",function(e,n,t,r){e.users=r,e.delete=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("SetDefaultUserEmailController",["$scope","$modalInstance","$timeout","email","confirmedAt",function(e,n,t,r,o){e.email=r,e.confirmedAt=o,e.confirm=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("DeleteDictionaryWordModalController",["$scope","$modalInstance","user","word",function(e,n,t,r){e.word=r,e.user=t,e.confirm=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("UserDictionaryController",["$scope","$http","$modal",function(e,n,t){e.user=window.data.user,e.dictionary=window.data.dictionary||[],e.inflight=!1,e.cancel=function(){return $modalInstance.dismiss("cancel")},e.confirm=function(){return $modalInstance.close()},e.deleteWord=function(r){t.open({templateUrl:"deleteDictionaryWordModalTemplate",controller:"DeleteDictionaryWordModalController",resolve:{word:function(){return r},user:function(){return e.user}}}).result.then((function(){e.inflight=!0,n({url:"/admin/user/".concat(e.user._id,"/spelling/delete"),method:"POST",data:{word:r},headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.inflight=!1;var n=e.dictionary.indexOf(r);e.dictionary.splice(n,1)})).catch((function(){return e.deleteError=!0}))}))},e.deleteDictionary=function(){t.open({templateUrl:"deleteDictionaryWordModalTemplate",controller:"DeleteDictionaryWordModalController",resolve:{word:function(){return"ALL WORDS"},user:function(){return e.user}}}).result.then((function(){e.inflight=!0,n({url:"/admin/user/".concat(e.user._id,"/spelling/delete"),method:"DELETE",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.inflight=!1,e.dictionary=[]})).catch((function(){return e.deleteError=!0}))}))}}]),e.controller("NewFeaturesOverrideModalController",["$scope","$modalInstance",function(e,n){e.cancel=function(){return n.dismiss("cancel")},e.reload=function(){return location.reload()}}]),e.controller("FeaturesOverrideController",["$scope","$http","$modal",function(e,n,t){e.newFeaturesOverride=function(){t.open({templateUrl:"newFeaturesOverrideTemplate",controller:"NewFeaturesOverrideModalController",size:"lg"})},e.deleteFeaturesOverride=function(t){e.inflight=!0,n({url:"/admin/user/".concat(e.user._id,"/features_override/").concat(t),method:"DELETE",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return location.reload()}))}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(11)],void 0===(o=function(e){e.controller("AdminSubscriptionController",["$scope","$http",function(e,n){e.subscription=window.data.subscription,e.createdAt=window.createdAt,e.deleteSubscription=function(){e.deleteError=!1,n({url:"/admin/subscription/".concat(e.subscription._id),method:"DELETE",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){window.location="/admin/deletedSubscription/".concat(e.subscription._id)})).catch((function(){return e.deleteError=!0}))},e.updateAdminFormManager={_visible:!1,data:{},open:function(){this.data.admin_id=e.subscription.admin_id,this._visible=!0},cancel:function(){this._visible=!1},onSuccess:function(){e.subscription.admin_id=this.data.admin_id,e.updateAdminForm.response.message={type:"success",text:"Subscription admin user updated"},this._visible=!1},isVisible:function(){return this._visible&&this.isEnabled()},isEnabled:function(){return e.subscription.customAccount}},e.onUpdateAdminSuccess=function(){e.updateAdminFormManager.onSuccess()}}]),e.controller("AdminCreateSubscriptionController",["$scope",function(e){e.subscription={customAccount:!0,groupPlan:!0,planCode:"professional",membersLimit:10,admin_id:window.data.admin_id},e.onSuccess=function(e){var n=e.data.subscription,t="/admin/subscription/".concat(n._id);window.location=t}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){e.controller("AdminDeletedSubscriptionController",["$scope","$http",function(e,n){e.subscription=window.data.subscription,e.deletedAt=window.deletedAt,e.createdAt=window.createdAt,e.restoreSubscription=function(){e.restoreError=null,n({url:"/admin/deletedSubscription/".concat(e.subscription._id,"/restore"),method:"POST",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){window.location="/admin/subscription/".concat(e.subscription._id)})).catch((function(n){e.restoreError={message:n.data.message||n.status}}))}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0),t(11)],void 0===(o=function(e){e.controller("AdminProjectController",["$scope","$timeout","$modal","$http","queuedHttp",function(e,n,t,r,o){var a=JSON.parse($("#admin-project-data").text()),i=a.project,c=a.deletedProject,l=a.docSnapshots,s=a.usersById;e.project=i,e.deletedProject=c,e.docSnapshots=l,e.usersById=s,e.editingBrandVariationId=!1,e.tagList=function(){return(e.project._ownerTags||[]).map((function(e){return e.name})).join(", ")},e.getRestoreEndpoint=function(e,n){return"/admin/project/".concat(e,"/doc_snapshot/").concat(n,"/restore")},e.openResyncModal=function(){t.open({templateUrl:"ResyncModalTemplate",controller:"ResyncModalController",resolve:{project:function(){return i}}}).result.then((function(){setTimeout((function(){return window.location.href="/admin/project/".concat(e.project._id)}),100)}))},e.openTransferOwnershipModal=function(){t.open({templateUrl:"TransferOwnershipModalTemplate",controller:"TransferOwnershipModalController",resolve:{project:function(){return i}}}).result.then((function(n){return o({method:"POST",url:"/project/".concat(e.project._id,"/transfer-ownership"),data:{user_id:n},headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return setTimeout((function(){return window.location.href="/admin/project/".concat(e.project._id)}),100)}))}))},e.undeleteProject=function(n){e.error=null,r.post("/admin/project/"+n._id+"/undelete",{_csrf:window.csrfToken}).then((function(){window.location.href="/admin/project/"+n._id}),(function(n){console.log(n),e.error="Failed to undelete project: ".concat(n.statusText)}))},e.getDeletedProjectField=function(e,n){return e.project?e.project[n]||"-":"scrubbed"},e.openDeleteProjectModal=function(){t.open({templateUrl:"DeleteProjectModalTemplate",controller:"DeleteProjectModalController",resolve:{project:function(){return i}}}).result.then((function(){return e.deleteProject()}))},e.deleteProject=function(){var n=e.project;o({method:"DELETE",url:"/admin/project/".concat(n._id,"?forever=true"),headers:{"X-CSRF-Token":window.csrfToken}}),window.location.href="/admin/user/".concat(n.owner_ref)}}]),e.controller("DeleteProjectModalController",["$scope","$modalInstance","$timeout","project",function(e,n,t,r){return e.project=r,e.delete=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("ResyncModalController",["$scope","$modalInstance","queuedHttp","project",function(e,n,t,r){return e.project=r,e.inflight=!1,e.state=null,e.confirm=function(){e.inflight=!0,t({method:"POST",url:"/admin/project/".concat(e.project._id,"/resync"),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.inflight=!1,e.state="success"})).catch((function(n){e.inflight=!1,e.state="error",e.error=n}))},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("TransferOwnershipModalController",["$scope","$modalInstance","$http","project",function(e,n,t,r){var o=/^[a-f\d]{24}$/i,a=/([^@]+)@(.+)/;return e.project=r,e.user_id="",e.inflight=!1,e.user={},e.findUser=function(){e.inflight=!0,t.get("/admin/user/info/"+encodeURIComponent(e.user_id)).then((function(n){e.inflight=!1,n.data.user?(e.user=n.data.user,e.user._id===e.project.owner_ref?e.state="self-transfer":e.state="success"):e.state="error"}),(function(n){e.inflight=!1,404===n.status||422===n.status?e.state="notfound":e.state="error"}))},e.validUserId=function(){return e.user_id.match(o)||e.user_id.match(a)},e.confirm=function(){return n.close(e.user._id)},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("AuditLogEntryController",["$scope",function(e){var n=e.entry,t=e.usersById;e.initiator=t[n.initiatorId],e.previousOwner=t[n.info.previousOwnerId],e.newOwner=t[n.info.newOwnerId]}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(39)],void 0===(o=function(){}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("DropboxRegistrationController",["$scope","$window","$http","$timeout",function(e,n,t,r){var o=window.location.hash.indexOf("access_token"),a={_csrf:window.csrfToken,tokenInfo:window.location.hash.slice(o)};return e.state="processing",t.post("/dropbox/completeRegistration",a).then((function(){e.state="success";return r((function(){return n.location.href="/user/settings"}),5e3)})).catch((function(n){var t=n.data;return e.state="error",t.error&&(e.error={code:t.error}),console.log("the request failed")}))}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(252),t(253),t(254)],void 0===(o=function(){}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("GithubSyncMenuEntryController",["$scope","$modal",function(e,n){return e.openImportModal=function(){return n.open({templateUrl:"githubSyncImportModalTemplate",controller:"GithubSyncImportModalController",size:"lg"})}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("GithubSyncImportModalController",["$scope","$modalInstance","$http",function(e,n,t){return e.cancel=function(){return n.dismiss()},e.handleError=function(n){var t=n.data,r=null;401===n.status?r="GithubCredentialsExpired":t&&t.error&&(r=t.error),e.status.error=!r||{code:r}},e.status={loading:!0,error:!1},t.get("/user/github-sync/status",{disableAutoLoginRedirect:!0}).then((function(n){var r=n.data;return e.status.user=r,r.enabled?t.get("/user/github-sync/repos",{disableAutoLoginRedirect:!0}).then((function(n){var t=n.data;return e.status.loading=!1,e.status.repos=t.repos})).catch(e.handleError):e.status.loading=!1})).catch((function(){return e.status.error=!0})),e.importRepo=function(n){return e.status.inflight=!0,t.post("/project/new/github-sync",{_csrf:window.csrfToken,projectName:n.name,repo:n.full_name,disableAutoLoginRedirect:!0}).then((function(e){var n=e.data.project_id;return window.location="/project/".concat(n)})).catch(e.handleError)}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("GithubSyncUnlinkController",["$scope","$modal",function(e,n){return e.unlinkAccount=function(){return n.open({templateUrl:"githubSyncUnlinkModalTemplate"})}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(256)],void 0===(o=function(){}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("LaunchpadController",["$scope","$http","$timeout",function(e,n,t){if(e.adminUserExists=window.data.adminUserExists,e.ideJsPath=window.data.ideJsPath,e.authMethod=window.data.authMethod,e.createAdminSuccess=null,e.createAdminError=null,e.statusChecks={ideJs:{status:"inflight",error:null},websocket:{status:"inflight",error:null},healthCheck:{status:"inflight",error:null}},e.testEmail={emailAddress:"",inflight:!1,status:null},e.shouldShowAdminForm=function(){return!e.adminUserExists},e.onCreateAdminSuccess=function(n){var t=n.status;if(t>=200&&t<300)return e.createAdminSuccess=!0},e.onCreateAdminError=function(){return e.createAdminError=!0},e.sendTestEmail=function(){return e.testEmail.inflight=!0,e.testEmail.status=null,n.post("/launchpad/send_test_email",{email:e.testEmail.emailAddress,_csrf:window.csrfToken}).then((function(n){var t=n.status;if(e.testEmail.inflight=!1,t>=200&&t<300)return e.testEmail.status="ok"})).catch((function(){return e.testEmail.inflight=!1,e.testEmail.status="error"}))},e.tryFetchIdeJs=function(){return e.statusChecks.ideJs.status="inflight",t((function(){return n.get(e.ideJsPath).then((function(n){var t=n.status;if(t>=200&&t<300)return e.statusChecks.ideJs.status="ok"})).catch((function(n){var t=n.status;return e.statusChecks.ideJs.status="error",e.statusChecks.ideJs.error=new Error("Http status: ".concat(t))}))}),1e3)},e.tryOpenWebSocket=function(){return e.statusChecks.websocket.status="inflight",t((function(){if("undefined"==typeof io||null===io)return e.statusChecks.websocket.status="error",void(e.statusChecks.websocket.error="socket.io not loaded");var n=io.connect(null,{reconnect:!1,"connect timeout":3e4,"force new connection":!0});return n.on("connectionAccepted",(function(){return e.statusChecks.websocket.status="ok",e.$apply((function(){}))})),n.on("connectionRejected",(function(n){return e.statusChecks.websocket.status="error",e.statusChecks.websocket.error=n,e.$apply((function(){}))})),n.on("connect_failed",(function(n){return e.statusChecks.websocket.status="error",e.statusChecks.websocket.error=n,e.$apply((function(){}))}))}),1e3)},e.tryHealthCheck=function(){return e.statusChecks.healthCheck.status="inflight",n.get("/health_check").then((function(n){var t=n.status;if(t>=200&&t<300)return e.statusChecks.healthCheck.status="ok"})).catch((function(n){var t=n.status;return e.statusChecks.healthCheck.status="error",e.statusChecks.healthCheck.error=new Error("Http status: ".concat(t))}))},e.runStatusChecks=function(){return t((function(){return e.tryFetchIdeJs()}),1e3),t((function(){return e.tryOpenWebSocket()}),2e3)},e.adminUserExists)return e.runStatusChecks()}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("OpenInOverleafGatewayController",["$scope","$http","localStorage",function(e,n,t){function r(e){document.referrer&&!e.referrer&&(e.referrer=document.referrer)}function o(e){return 0===Object.keys(e).filter((function(e){return"referrer"!==e})).length?JSON.parse(window.sessionStorage.getItem("openInOverleaf"))||{}:e}e.error=!1,e.handleGateway=function(){var a,i,c=JSON.parse($("#overleaf-gateway-data").text());r(c.params),function(e){if(e.error)return!0;if("store"===e.action&&""!==e.target&&e.params)return!0;return"submit"===e.action&&e.params}(c)?c.error?e.serverError=c.error:"store"===c.action?(a=o(c.params),i=c.target,r(a),window.sessionStorage.setItem("openInOverleaf",JSON.stringify(a)),window.location.replace(i)):"submit"===c.action&&function(r,o){r._csrf=o,n({method:"POST",url:window.location.pathname,data:r}).then((function(n){n.error?e.serverError=n.error:n.data&&n.data.redirect?("true"===r.rich_text&&t("editor.mode."+n.data.projectId,"rich-text"),window.sessionStorage.setItem("openInOverleaf","{}"),window.location.replace(n.data.redirect)):e.error=!0}),(function(n){n.data&&n.data.error?e.serverError=n.data.error:e.error=!0}))}(o(c.params),c.csrfToken):e.error=!0}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){e.controller("InstitutionFormController",["$scope",function(e){e.inflight=!1,e.inflightItem=null,e.samlInitPath=ExposedSettings.samlInitPath,e.submit=function(n){e.inflight=!0,e.inflightItem=n}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("PortalFormController",["$scope","$http",function(e,n){var t="Yes! I would like to explore an Overleaf Institutional Account.";e.form={department:"",email:"",firstName:"",lastName:"",message:t,role:""},e.sent=!1,e.sending=!1,e.submitSupport=function(){if(null!=e.form.email&&""!==e.form.email){e.sending=!0;var r=e.form,o=r.department,a=r.firstName,i=r.lastName,c=r.message,l=r.role,s="".concat(e.siteUrl,"/").concat(e.portalType,"/").concat(e.portalSlug),u="\n        \n**Overleaf Portal Contact**\n        \n**Name:** ".concat(a," ").concat(i,"\n        \n**Message:** ").concat(c,"\n        \n**Role:** ").concat(l,"\n        \n**Department:** ").concat(o,"\n        \n**Portal:** ").concat(e.portalTitle,"\n        \n**Portal Link:** ").concat(s,"\n        "),d=c.trim()===t?"":"Custom Portal Message",f={_csrf:window.csrfToken,email:e.form.email,message:u||"",subject:"Overleaf Portal Contact",inbox:"portals",tags:d},p=n.post("/support",f);return p.then((function(n){return e.sent=!0})),p.catch((function(){return e.error=!0,console.log("the request failed")}))}e.error="Please include your email"}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){t(73)},function(e,n,t){var r,o;r=[t(0),t(41)],void 0===(o=function(e,n){e.controller("openInSlController",["$scope","$http","$window","$timeout",function(e,n,t,r){return e.openInSlText="Open in ShareLaTeX",e.isDisabled=!1,e.state={unpublishInFlight:!1,republishInFlight:!1,apiProblem:!1},e.buttonsDisabled=function(){return e.state.unpublishInFlight||e.state.republishInFlight},e.open=function(){return e.openInSlText="Creating...",e.isDisabled=!0,ga("send","event","template-site","open-in-sl",$(".page-header h1").text())},e.downloadZip=function(){return ga("send","event","template-site","download-zip",$(".page-header h1").text())},e.republish=function(r){return e.state.republishInFlight=!0,n.post("/project/".concat(r,"/template/publish"),{_csrf:window.csrfToken}).then((function(){return e.state.republishInFlight=!1,e.state.apiProblem=!1,t.location.reload()})).catch((function(){return e.state.republishInFlight=!1,e.state.apiProblem=!1}))},e.unpublish=function(o){return e.state.unpublishInFlight=!0,n.post("/project/".concat(o,"/template/unpublish"),{_csrf:window.csrfToken}).then((function(){return e.state.unpublishInFlight=!1,e.state.apiProblem=!1,r((function(){return t.location.href="/templates"}),500)})).catch((function(){return e.state.unpublishInFlight=!1,console.log(">> unpub failed"),e.state.apiProblem=!0}))}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(263)],void 0===(o=function(){}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("ReferenceUnlinkController",["$scope","$modal",function(e,n){return e.unlinkAccount=function(e){return n.open({templateUrl:"referenceUnlinkModalTemplate",controller:"ReferenceUnlinkModalController",resolve:{provider:function(){return e}}})}}]),e.controller("ReferenceUnlinkModalController",["$scope","$modalInstance","provider",function(e,n,t){return e.provider=t,e.providerUnlink="/".concat(t,"/unlink")}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(265),t(266)],void 0===(o=function(){}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.controller("TemplatePageController",["$scope","$modal",function(e,n){e.openViewSourceModal=function(){n.open({templateUrl:"viewSourceModalTemplate"})}}])}.apply(n,r))||(e.exports=o)},function(e,n,t){var r,o;r=[t(0)],void 0===(o=function(e){return e.directive("addsearch",(function(){return{link:function(e,n,t){var r=n.find("input");return n.find("button").on("click",(function(e){return window.location.search="addsearch=".concat(r.val())}))}}}))}.apply(n,r))||(e.exports=o)}])}));
//# sourceMappingURL=main-6cfa6a0e1fd85eafd565.js.map